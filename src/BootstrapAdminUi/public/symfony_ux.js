/*! For license information please see symfony_ux.js.LICENSE.txt */
(()=>{var e={490:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=490,e.exports=t},371:function(e){e.exports=function(){"use strict";function e(e,t){e.split(/\s+/).forEach((e=>{t(e)}))}class t{constructor(){this._events=void 0,this._events={}}on(t,n){e(t,(e=>{const t=this._events[e]||[];t.push(n),this._events[e]=t}))}off(t,n){var s=arguments.length;0!==s?e(t,(e=>{if(1===s)return void delete this._events[e];const t=this._events[e];void 0!==t&&(t.splice(t.indexOf(n),1),this._events[e]=t)})):this._events={}}trigger(t,...n){var s=this;e(t,(e=>{const t=s._events[e];void 0!==t&&t.forEach((e=>{e.apply(s,n)}))}))}}function n(e){return e.plugins={},class extends e{constructor(...e){super(...e),this.plugins={names:[],settings:{},requested:{},loaded:{}}}static define(t,n){e.plugins[t]={name:t,fn:n}}initializePlugins(e){var t,n;const s=this,i=[];if(Array.isArray(e))e.forEach((e=>{"string"==typeof e?i.push(e):(s.plugins.settings[e.name]=e.options,i.push(e.name))}));else if(e)for(t in e)e.hasOwnProperty(t)&&(s.plugins.settings[t]=e[t],i.push(t));for(;n=i.shift();)s.require(n)}loadPlugin(t){var n=this,s=n.plugins,i=e.plugins[t];if(!e.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');s.requested[t]=!0,s.loaded[t]=i.fn.apply(n,[n.plugins.settings[t]||{}]),s.names.push(t)}require(e){var t=this,n=t.plugins;if(!t.plugins.loaded.hasOwnProperty(e)){if(n.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');t.loadPlugin(e)}return n.loaded[e]}}}const s=e=>(e=e.filter(Boolean)).length<2?e[0]||"":1==l(e)?"["+e.join("")+"]":"(?:"+e.join("|")+")",i=e=>{if(!o(e))return e.join("");let t="",n=0;const s=()=>{n>1&&(t+="{"+n+"}")};return e.forEach(((i,r)=>{i!==e[r-1]?(s(),t+=i,n=1):n++})),s(),t},r=e=>{let t=d(e);return s(t)},o=e=>new Set(e).size!==e.length,a=e=>(e+"").replace(/([\$\(\)\*\+\.\?\[\]\^\{\|\}\\])/gu,"\\$1"),l=e=>e.reduce(((e,t)=>Math.max(e,c(t))),0),c=e=>d(e).length,d=e=>Array.from(e),h=e=>{if(1===e.length)return[[e]];let t=[];const n=e.substring(1);return h(n).forEach((function(n){let s=n.slice(0);s[0]=e.charAt(0)+s[0],t.push(s),s=n.slice(0),s.unshift(e.charAt(0)),t.push(s)})),t},u=[[0,65535]],p="[̀-ͯ·ʾʼ]";let m,g;const f=3,v={},b={"/":"⁄∕",0:"߀",a:"ⱥɐɑ",aa:"ꜳ",ae:"æǽǣ",ao:"ꜵ",au:"ꜷ",av:"ꜹꜻ",ay:"ꜽ",b:"ƀɓƃ",c:"ꜿƈȼↄ",d:"đɗɖᴅƌꮷԁɦ",e:"ɛǝᴇɇ",f:"ꝼƒ",g:"ǥɠꞡᵹꝿɢ",h:"ħⱨⱶɥ",i:"ɨı",j:"ɉȷ",k:"ƙⱪꝁꝃꝅꞣ",l:"łƚɫⱡꝉꝇꞁɭ",m:"ɱɯϻ",n:"ꞥƞɲꞑᴎлԉ",o:"øǿɔɵꝋꝍᴑ",oe:"œ",oi:"ƣ",oo:"ꝏ",ou:"ȣ",p:"ƥᵽꝑꝓꝕρ",q:"ꝗꝙɋ",r:"ɍɽꝛꞧꞃ",s:"ßȿꞩꞅʂ",t:"ŧƭʈⱦꞇ",th:"þ",tz:"ꜩ",u:"ʉ",v:"ʋꝟʌ",vy:"ꝡ",w:"ⱳ",y:"ƴɏỿ",z:"ƶȥɀⱬꝣ",hv:"ƕ"};for(let e in b){let t=b[e]||"";for(let n=0;n<t.length;n++){let s=t.substring(n,n+1);v[s]=e}}const y=new RegExp(Object.keys(v).join("|")+"|"+p,"gu"),E=e=>{void 0===m&&(m=C(e||u))},O=(e,t="NFKD")=>e.normalize(t),w=e=>d(e).reduce(((e,t)=>e+A(t)),""),A=e=>(e=O(e).toLowerCase().replace(y,(e=>v[e]||"")),O(e,"NFC"));function*k(e){for(const[t,n]of e)for(let e=t;e<=n;e++){let t=String.fromCharCode(e),n=w(t);n!=t.toLowerCase()&&(n.length>f||0!=n.length&&(yield{folded:n,composed:t,code_point:e}))}}const S=e=>{const t={},n=(e,n)=>{const s=t[e]||new Set,i=new RegExp("^"+r(s)+"$","iu");n.match(i)||(s.add(a(n)),t[e]=s)};for(let t of k(e))n(t.folded,t.folded),n(t.folded,t.composed);return t},C=e=>{const t=S(e),n={};let i=[];for(let e in t){let s=t[e];s&&(n[e]=r(s)),e.length>1&&i.push(a(e))}i.sort(((e,t)=>t.length-e.length));const o=s(i);return g=new RegExp("^"+o,"u"),n},M=(e,t=1)=>{let n=0;return e=e.map((e=>(m[e]&&(n+=e.length),m[e]||e))),n>=t?i(e):""},T=(e,t=1)=>(t=Math.max(t,e.length-1),s(h(e).map((e=>M(e,t))))),F=(e,t=!0)=>{let n=e.length>1?1:0;return s(e.map((e=>{let s=[];const r=t?e.length():e.length()-1;for(let t=0;t<r;t++)s.push(T(e.substrs[t]||"",n));return i(s)})))},x=(e,t)=>{for(const n of t){if(n.start!=e.start||n.end!=e.end)continue;if(n.substrs.join("")!==e.substrs.join(""))continue;let t=e.parts;const s=e=>{for(const n of t){if(n.start===e.start&&n.substr===e.substr)return!1;if(1!=e.length&&1!=n.length){if(e.start<n.start&&e.end>n.start)return!0;if(n.start<e.start&&n.end>e.start)return!0}}return!1};if(!(n.parts.filter(s).length>0))return!0}return!1};class I{constructor(){this.parts=[],this.substrs=[],this.start=0,this.end=0}add(e){e&&(this.parts.push(e),this.substrs.push(e.substr),this.start=Math.min(e.start,this.start),this.end=Math.max(e.end,this.end))}last(){return this.parts[this.parts.length-1]}length(){return this.parts.length}clone(e,t){let n=new I,s=JSON.parse(JSON.stringify(this.parts)),i=s.pop();for(const e of s)n.add(e);let r=t.substr.substring(0,e-i.start),o=r.length;return n.add({start:i.start,end:i.start+o,length:o,substr:r}),n}}const N=e=>{E(),e=w(e);let t="",n=[new I];for(let s=0;s<e.length;s++){let i=e.substring(s).match(g);const r=e.substring(s,s+1),o=i?i[0]:null;let a=[],l=new Set;for(const e of n){const t=e.last();if(!t||1==t.length||t.end<=s)if(o){const t=o.length;e.add({start:s,end:s+t,length:t,substr:o}),l.add("1")}else e.add({start:s,end:s+1,length:1,substr:r}),l.add("2");else if(o){let n=e.clone(s,t);const i=o.length;n.add({start:s,end:s+i,length:i,substr:o}),a.push(n)}else l.add("3")}if(a.length>0){a=a.sort(((e,t)=>e.length()-t.length()));for(let e of a)x(e,n)||n.push(e)}else if(s>0&&1==l.size&&!l.has("3")){t+=F(n,!1);let e=new I;const s=n[0];s&&e.add(s.last()),n=[e]}}return t+=F(n,!0),t},L=(e,t)=>{if(e)return e[t]},P=(e,t)=>{if(e){for(var n,s=t.split(".");(n=s.shift())&&(e=e[n]););return e}},$=(e,t,n)=>{var s,i;return e?(e+="",null==t.regex||-1===(i=e.search(t.regex))?0:(s=t.string.length/e.length,0===i&&(s+=.5),s*n)):0},_=(e,t)=>{var n=e[t];if("function"==typeof n)return n;n&&!Array.isArray(n)&&(e[t]=[n])},D=(e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)},V=(e,t)=>"number"==typeof e&&"number"==typeof t?e>t?1:e<t?-1:0:(e=w(e+"").toLowerCase())>(t=w(t+"").toLowerCase())?1:t>e?-1:0;class j{constructor(e,t){this.items=void 0,this.settings=void 0,this.items=e,this.settings=t||{diacritics:!0}}tokenize(e,t,n){if(!e||!e.length)return[];const s=[],i=e.split(/\s+/);var r;return n&&(r=new RegExp("^("+Object.keys(n).map(a).join("|")+"):(.*)$")),i.forEach((e=>{let n,i=null,o=null;r&&(n=e.match(r))&&(i=n[1],e=n[2]),e.length>0&&(o=this.settings.diacritics?N(e)||null:a(e),o&&t&&(o="\\b"+o)),s.push({string:e,regex:o?new RegExp(o,"iu"):null,field:i})})),s}getScoreFunction(e,t){var n=this.prepareSearch(e,t);return this._getScoreFunction(n)}_getScoreFunction(e){const t=e.tokens,n=t.length;if(!n)return function(){return 0};const s=e.options.fields,i=e.weights,r=s.length,o=e.getAttrFn;if(!r)return function(){return 1};const a=1===r?function(e,t){const n=s[0].field;return $(o(t,n),e,i[n]||1)}:function(e,t){var n=0;if(e.field){const s=o(t,e.field);!e.regex&&s?n+=1/r:n+=$(s,e,1)}else D(i,((s,i)=>{n+=$(o(t,i),e,s)}));return n/r};return 1===n?function(e){return a(t[0],e)}:"and"===e.options.conjunction?function(e){var s,i=0;for(let n of t){if((s=a(n,e))<=0)return 0;i+=s}return i/n}:function(e){var s=0;return D(t,(t=>{s+=a(t,e)})),s/n}}getSortFunction(e,t){var n=this.prepareSearch(e,t);return this._getSortFunction(n)}_getSortFunction(e){var t,n=[];const s=this,i=e.options,r=!e.query&&i.sort_empty?i.sort_empty:i.sort;if("function"==typeof r)return r.bind(this);const o=function(t,n){return"$score"===t?n.score:e.getAttrFn(s.items[n.id],t)};if(r)for(let t of r)(e.query||"$score"!==t.field)&&n.push(t);if(e.query){t=!0;for(let e of n)if("$score"===e.field){t=!1;break}t&&n.unshift({field:"$score",direction:"desc"})}else n=n.filter((e=>"$score"!==e.field));return n.length?function(e,t){var s,i;for(let r of n)if(i=r.field,s=("desc"===r.direction?-1:1)*V(o(i,e),o(i,t)))return s;return 0}:null}prepareSearch(e,t){const n={};var s=Object.assign({},t);if(_(s,"sort"),_(s,"sort_empty"),s.fields){_(s,"fields");const e=[];s.fields.forEach((t=>{"string"==typeof t&&(t={field:t,weight:1}),e.push(t),n[t.field]="weight"in t?t.weight:1})),s.fields=e}return{options:s,query:e.toLowerCase().trim(),tokens:this.tokenize(e,s.respect_word_boundaries,n),total:0,items:[],weights:n,getAttrFn:s.nesting?P:L}}search(e,t){var n,s,i=this;s=this.prepareSearch(e,t),t=s.options,e=s.query;const r=t.score||i._getScoreFunction(s);e.length?D(i.items,((e,i)=>{n=r(e),(!1===t.filter||n>0)&&s.items.push({score:n,id:i})})):D(i.items,((e,t)=>{s.items.push({score:1,id:t})}));const o=i._getSortFunction(s);return o&&s.items.sort(o),s.total=s.items.length,"number"==typeof t.limit&&(s.items=s.items.slice(0,t.limit)),s}}const B=(e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)},R=e=>{if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(q(e)){var t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild}return document.querySelector(e)},q=e=>"string"==typeof e&&e.indexOf("<")>-1,H=e=>e.replace(/['"\\]/g,"\\$&"),U=(e,t)=>{var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!1),e.dispatchEvent(n)},K=(e,t)=>{Object.assign(e.style,t)},z=(e,...t)=>{var n=J(t);(e=G(e)).map((e=>{n.map((t=>{e.classList.add(t)}))}))},W=(e,...t)=>{var n=J(t);(e=G(e)).map((e=>{n.map((t=>{e.classList.remove(t)}))}))},J=e=>{var t=[];return B(e,(e=>{"string"==typeof e&&(e=e.trim().split(/[\11\12\14\15\40]/)),Array.isArray(e)&&(t=t.concat(e))})),t.filter(Boolean)},G=e=>(Array.isArray(e)||(e=[e]),e),Q=(e,t,n)=>{if(!n||n.contains(e))for(;e&&e.matches;){if(e.matches(t))return e;e=e.parentNode}},X=(e,t=0)=>t>0?e[e.length-1]:e[0],Y=e=>0===Object.keys(e).length,Z=(e,t)=>{if(!e)return-1;t=t||e.nodeName;for(var n=0;e=e.previousElementSibling;)e.matches(t)&&n++;return n},ee=(e,t)=>{B(t,((t,n)=>{null==t?e.removeAttribute(n):e.setAttribute(n,""+t)}))},te=(e,t)=>{e.parentNode&&e.parentNode.replaceChild(t,e)},ne=(e,t)=>{if(null===t)return;if("string"==typeof t){if(!t.length)return;t=new RegExp(t,"i")}const n=e=>{var n=e.data.match(t);if(n&&e.data.length>0){var s=document.createElement("span");s.className="highlight";var i=e.splitText(n.index);i.splitText(n[0].length);var r=i.cloneNode(!0);return s.appendChild(r),te(i,s),1}return 0},s=e=>{1!==e.nodeType||!e.childNodes||/(script|style)/i.test(e.tagName)||"highlight"===e.className&&"SPAN"===e.tagName||Array.from(e.childNodes).forEach((e=>{i(e)}))},i=e=>3===e.nodeType?n(e):(s(e),0);i(e)},se=e=>{var t=e.querySelectorAll("span.highlight");Array.prototype.forEach.call(t,(function(e){var t=e.parentNode;t.replaceChild(e.firstChild,e),t.normalize()}))},ie=65,re=13,oe=27,ae=37,le=38,ce=39,de=40,he=8,ue=46,pe=9,me="undefined"!=typeof navigator&&/Mac/.test(navigator.userAgent)?"metaKey":"ctrlKey";var ge={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:null,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:null,allowEmptyOption:!1,refreshThrottle:300,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-wrapper",controlClass:"ts-control",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:'<input type="text" autocomplete="off" size="1" />',copyClassesToDropdown:!1,placeholder:null,hidePlaceholder:null,shouldLoad:function(e){return e.length>0},render:{}};const fe=e=>null==e?null:ve(e),ve=e=>"boolean"==typeof e?e?"1":"0":e+"",be=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),ye=(e,t)=>t>0?setTimeout(e,t):(e.call(null),null),Ee=(e,t)=>{var n;return function(s,i){var r=this;n&&(r.loading=Math.max(r.loading-1,0),clearTimeout(n)),n=setTimeout((function(){n=null,r.loadedSearches[s]=!0,e.call(r,s,i)}),t)}},Oe=(e,t,n)=>{var s,i=e.trigger,r={};for(s of(e.trigger=function(){var n=arguments[0];if(-1===t.indexOf(n))return i.apply(e,arguments);r[n]=arguments},n.apply(e,[]),e.trigger=i,t))s in r&&i.apply(e,r[s])},we=e=>({start:e.selectionStart||0,length:(e.selectionEnd||0)-(e.selectionStart||0)}),Ae=(e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())},ke=(e,t,n,s)=>{e.addEventListener(t,n,s)},Se=(e,t)=>!!t&&!!t[e]&&1==(t.altKey?1:0)+(t.ctrlKey?1:0)+(t.shiftKey?1:0)+(t.metaKey?1:0),Ce=(e,t)=>{const n=e.getAttribute("id");return n||(e.setAttribute("id",t),t)},Me=e=>e.replace(/[\\"']/g,"\\$&"),Te=(e,t)=>{t&&e.append(t)};function Fe(e,t){var n=Object.assign({},ge,t),s=n.dataAttr,i=n.labelField,r=n.valueField,o=n.disabledField,a=n.optgroupField,l=n.optgroupLabelField,c=n.optgroupValueField,d=e.tagName.toLowerCase(),h=e.getAttribute("placeholder")||e.getAttribute("data-placeholder");if(!h&&!n.allowEmptyOption){let t=e.querySelector('option[value=""]');t&&(h=t.textContent)}var u={placeholder:h,options:[],optgroups:[],items:[],maxItems:null},p=()=>{const t=e.getAttribute(s);if(t)u.options=JSON.parse(t),B(u.options,(e=>{u.items.push(e[r])}));else{var o=e.value.trim()||"";if(!n.allowEmptyOption&&!o.length)return;const t=o.split(n.delimiter);B(t,(e=>{const t={};t[i]=e,t[r]=e,u.options.push(t)})),u.items=t}};return"select"===d?(()=>{var t,d=u.options,h={},p=1;let m=0;var g=e=>{var t=Object.assign({},e.dataset),n=s&&t[s];return"string"==typeof n&&n.length&&(t=Object.assign(t,JSON.parse(n))),t},f=(e,t)=>{var s=fe(e.value);if(null!=s&&(s||n.allowEmptyOption)){if(h.hasOwnProperty(s)){if(t){var l=h[s][a];l?Array.isArray(l)?l.push(t):h[s][a]=[l,t]:h[s][a]=t}}else{var c=g(e);c[i]=c[i]||e.textContent,c[r]=c[r]||s,c[o]=c[o]||e.disabled,c[a]=c[a]||t,c.$option=e,c.$order=c.$order||++m,h[s]=c,d.push(c)}e.selected&&u.items.push(s)}},v=e=>{var t,n;(n=g(e))[l]=n[l]||e.getAttribute("label")||"",n[c]=n[c]||p++,n[o]=n[o]||e.disabled,n.$order=n.$order||++m,u.optgroups.push(n),t=n[c],B(e.children,(e=>{f(e,t)}))};u.maxItems=e.hasAttribute("multiple")?null:1,B(e.children,(e=>{"optgroup"===(t=e.tagName.toLowerCase())?v(e):"option"===t&&f(e)}))})():p(),Object.assign({},ge,u,t)}var xe=0;class Ie extends(n(t)){constructor(e,t){var n;super(),this.control_input=void 0,this.wrapper=void 0,this.dropdown=void 0,this.control=void 0,this.dropdown_content=void 0,this.focus_node=void 0,this.order=0,this.settings=void 0,this.input=void 0,this.tabIndex=void 0,this.is_select_tag=void 0,this.rtl=void 0,this.inputId=void 0,this._destroy=void 0,this.sifter=void 0,this.isOpen=!1,this.isDisabled=!1,this.isReadOnly=!1,this.isRequired=void 0,this.isInvalid=!1,this.isValid=!0,this.isLocked=!1,this.isFocused=!1,this.isInputHidden=!1,this.isSetup=!1,this.ignoreFocus=!1,this.ignoreHover=!1,this.hasOptions=!1,this.currentResults=void 0,this.lastValue="",this.caretPos=0,this.loading=0,this.loadedSearches={},this.activeOption=null,this.activeItems=[],this.optgroups={},this.options={},this.userOptions={},this.items=[],this.refreshTimeout=null,xe++;var s=R(e);if(s.tomselect)throw new Error("Tom Select already initialized on this element");s.tomselect=this,n=(window.getComputedStyle&&window.getComputedStyle(s,null)).getPropertyValue("direction");const i=Fe(s,t);this.settings=i,this.input=s,this.tabIndex=s.tabIndex||0,this.is_select_tag="select"===s.tagName.toLowerCase(),this.rtl=/rtl/i.test(n),this.inputId=Ce(s,"tomselect-"+xe),this.isRequired=s.required,this.sifter=new j(this.options,{diacritics:i.diacritics}),i.mode=i.mode||(1===i.maxItems?"single":"multi"),"boolean"!=typeof i.hideSelected&&(i.hideSelected="multi"===i.mode),"boolean"!=typeof i.hidePlaceholder&&(i.hidePlaceholder="multi"!==i.mode);var r=i.createFilter;"function"!=typeof r&&("string"==typeof r&&(r=new RegExp(r)),r instanceof RegExp?i.createFilter=e=>r.test(e):i.createFilter=e=>this.settings.duplicates||!this.options[e]),this.initializePlugins(i.plugins),this.setupCallbacks(),this.setupTemplates();const o=R("<div>"),a=R("<div>"),l=this._render("dropdown"),c=R('<div role="listbox" tabindex="-1">'),d=this.input.getAttribute("class")||"",h=i.mode;var u;z(o,i.wrapperClass,d,h),z(a,i.controlClass),Te(o,a),z(l,i.dropdownClass,h),i.copyClassesToDropdown&&z(l,d),z(c,i.dropdownContentClass),Te(l,c),R(i.dropdownParent||o).appendChild(l),q(i.controlInput)?(u=R(i.controlInput),D(["autocorrect","autocapitalize","autocomplete","spellcheck"],(e=>{s.getAttribute(e)&&ee(u,{[e]:s.getAttribute(e)})})),u.tabIndex=-1,a.appendChild(u),this.focus_node=u):i.controlInput?(u=R(i.controlInput),this.focus_node=u):(u=R("<input/>"),this.focus_node=a),this.wrapper=o,this.dropdown=l,this.dropdown_content=c,this.control=a,this.control_input=u,this.setup()}setup(){const e=this,t=e.settings,n=e.control_input,s=e.dropdown,i=e.dropdown_content,r=e.wrapper,o=e.control,l=e.input,c=e.focus_node,d={passive:!0},h=e.inputId+"-ts-dropdown";ee(i,{id:h}),ee(c,{role:"combobox","aria-haspopup":"listbox","aria-expanded":"false","aria-controls":h});const u=Ce(c,e.inputId+"-ts-control"),p="label[for='"+H(e.inputId)+"']",m=document.querySelector(p),g=e.focus.bind(e);if(m){ke(m,"click",g),ee(m,{for:u});const t=Ce(m,e.inputId+"-ts-label");ee(c,{"aria-labelledby":t}),ee(i,{"aria-labelledby":t})}if(r.style.width=l.style.width,e.plugins.names.length){const t="plugin-"+e.plugins.names.join(" plugin-");z([r,s],t)}(null===t.maxItems||t.maxItems>1)&&e.is_select_tag&&ee(l,{multiple:"multiple"}),t.placeholder&&ee(n,{placeholder:t.placeholder}),!t.splitOn&&t.delimiter&&(t.splitOn=new RegExp("\\s*"+a(t.delimiter)+"+\\s*")),t.load&&t.loadThrottle&&(t.load=Ee(t.load,t.loadThrottle)),ke(s,"mousemove",(()=>{e.ignoreHover=!1})),ke(s,"mouseenter",(t=>{var n=Q(t.target,"[data-selectable]",s);n&&e.onOptionHover(t,n)}),{capture:!0}),ke(s,"click",(t=>{const n=Q(t.target,"[data-selectable]");n&&(e.onOptionSelect(t,n),Ae(t,!0))})),ke(o,"click",(t=>{var s=Q(t.target,"[data-ts-item]",o);s&&e.onItemSelect(t,s)?Ae(t,!0):""==n.value&&(e.onClick(),Ae(t,!0))})),ke(c,"keydown",(t=>e.onKeyDown(t))),ke(n,"keypress",(t=>e.onKeyPress(t))),ke(n,"input",(t=>e.onInput(t))),ke(c,"blur",(t=>e.onBlur(t))),ke(c,"focus",(t=>e.onFocus(t))),ke(n,"paste",(t=>e.onPaste(t)));const f=t=>{const i=t.composedPath()[0];if(!r.contains(i)&&!s.contains(i))return e.isFocused&&e.blur(),void e.inputState();i==n&&e.isOpen?t.stopPropagation():Ae(t,!0)},v=()=>{e.isOpen&&e.positionDropdown()};ke(document,"mousedown",f),ke(window,"scroll",v,d),ke(window,"resize",v,d),this._destroy=()=>{document.removeEventListener("mousedown",f),window.removeEventListener("scroll",v),window.removeEventListener("resize",v),m&&m.removeEventListener("click",g)},this.revertSettings={innerHTML:l.innerHTML,tabIndex:l.tabIndex},l.tabIndex=-1,l.insertAdjacentElement("afterend",e.wrapper),e.sync(!1),t.items=[],delete t.optgroups,delete t.options,ke(l,"invalid",(()=>{e.isValid&&(e.isValid=!1,e.isInvalid=!0,e.refreshState())})),e.updateOriginalInput(),e.refreshItems(),e.close(!1),e.inputState(),e.isSetup=!0,l.disabled?e.disable():l.readOnly?e.setReadOnly(!0):e.enable(),e.on("change",this.onChange),z(l,"tomselected","ts-hidden-accessible"),e.trigger("initialize"),!0===t.preload&&e.preload()}setupOptions(e=[],t=[]){this.addOptions(e),D(t,(e=>{this.registerOptionGroup(e)}))}setupTemplates(){var e=this,t=e.settings.labelField,n=e.settings.optgroupLabelField,s={optgroup:e=>{let t=document.createElement("div");return t.className="optgroup",t.appendChild(e.options),t},optgroup_header:(e,t)=>'<div class="optgroup-header">'+t(e[n])+"</div>",option:(e,n)=>"<div>"+n(e[t])+"</div>",item:(e,n)=>"<div>"+n(e[t])+"</div>",option_create:(e,t)=>'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"};e.settings.render=Object.assign({},s,e.settings.render)}setupCallbacks(){var e,t,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in n)(t=this.settings[n[e]])&&this.on(e,t)}sync(e=!0){const t=this,n=e?Fe(t.input,{delimiter:t.settings.delimiter}):t.settings;t.setupOptions(n.options,n.optgroups),t.setValue(n.items||[],!0),t.lastQuery=null}onClick(){var e=this;if(e.activeItems.length>0)return e.clearActiveItems(),void e.focus();e.isFocused&&e.isOpen?e.blur():e.focus()}onMouseDown(){}onChange(){U(this.input,"input"),U(this.input,"change")}onPaste(e){var t=this;t.isInputHidden||t.isLocked?Ae(e):t.settings.splitOn&&setTimeout((()=>{var e=t.inputValue();if(e.match(t.settings.splitOn)){var n=e.trim().split(t.settings.splitOn);D(n,(e=>{fe(e)&&(this.options[e]?t.addItem(e):t.createItem(e))}))}}),0)}onKeyPress(e){var t=this;if(!t.isLocked){var n=String.fromCharCode(e.keyCode||e.which);return t.settings.create&&"multi"===t.settings.mode&&n===t.settings.delimiter?(t.createItem(),void Ae(e)):void 0}Ae(e)}onKeyDown(e){var t=this;if(t.ignoreHover=!0,t.isLocked)e.keyCode!==pe&&Ae(e);else{switch(e.keyCode){case ie:if(Se(me,e)&&""==t.control_input.value)return Ae(e),void t.selectAll();break;case oe:return t.isOpen&&(Ae(e,!0),t.close()),void t.clearActiveItems();case de:if(!t.isOpen&&t.hasOptions)t.open();else if(t.activeOption){let e=t.getAdjacent(t.activeOption,1);e&&t.setActiveOption(e)}return void Ae(e);case le:if(t.activeOption){let e=t.getAdjacent(t.activeOption,-1);e&&t.setActiveOption(e)}return void Ae(e);case re:return void(t.canSelect(t.activeOption)?(t.onOptionSelect(e,t.activeOption),Ae(e)):(t.settings.create&&t.createItem()||document.activeElement==t.control_input&&t.isOpen)&&Ae(e));case ae:return void t.advanceSelection(-1,e);case ce:return void t.advanceSelection(1,e);case pe:return void(t.settings.selectOnTab&&(t.canSelect(t.activeOption)&&(t.onOptionSelect(e,t.activeOption),Ae(e)),t.settings.create&&t.createItem()&&Ae(e)));case he:case ue:return void t.deleteSelection(e)}t.isInputHidden&&!Se(me,e)&&Ae(e)}}onInput(e){if(this.isLocked)return;const t=this.inputValue();this.lastValue!==t&&(this.lastValue=t,""!=t?(this.refreshTimeout&&clearTimeout(this.refreshTimeout),this.refreshTimeout=ye((()=>{this.refreshTimeout=null,this._onInput()}),this.settings.refreshThrottle)):this._onInput())}_onInput(){const e=this.lastValue;this.settings.shouldLoad.call(this,e)&&this.load(e),this.refreshOptions(),this.trigger("type",e)}onOptionHover(e,t){this.ignoreHover||this.setActiveOption(t,!1)}onFocus(e){var t=this,n=t.isFocused;if(t.isDisabled||t.isReadOnly)return t.blur(),void Ae(e);t.ignoreFocus||(t.isFocused=!0,"focus"===t.settings.preload&&t.preload(),n||t.trigger("focus"),t.activeItems.length||(t.inputState(),t.refreshOptions(!!t.settings.openOnFocus)),t.refreshState())}onBlur(e){if(!1!==document.hasFocus()){var t=this;if(t.isFocused){t.isFocused=!1,t.ignoreFocus=!1;var n=()=>{t.close(),t.setActiveItem(),t.setCaret(t.items.length),t.trigger("blur")};t.settings.create&&t.settings.createOnBlur?t.createItem(null,n):n()}}}onOptionSelect(e,t){var n,s=this;t.parentElement&&t.parentElement.matches("[data-disabled]")||(t.classList.contains("create")?s.createItem(null,(()=>{s.settings.closeAfterSelect&&s.close()})):void 0!==(n=t.dataset.value)&&(s.lastQuery=null,s.addItem(n),s.settings.closeAfterSelect&&s.close(),!s.settings.hideSelected&&e.type&&/click/.test(e.type)&&s.setActiveOption(t)))}canSelect(e){return!!(this.isOpen&&e&&this.dropdown_content.contains(e))}onItemSelect(e,t){var n=this;return!n.isLocked&&"multi"===n.settings.mode&&(Ae(e),n.setActiveItem(t,e),!0)}canLoad(e){return!!this.settings.load&&!this.loadedSearches.hasOwnProperty(e)}load(e){const t=this;if(!t.canLoad(e))return;z(t.wrapper,t.settings.loadingClass),t.loading++;const n=t.loadCallback.bind(t);t.settings.load.call(t,e,n)}loadCallback(e,t){const n=this;n.loading=Math.max(n.loading-1,0),n.lastQuery=null,n.clearActiveOption(),n.setupOptions(e,t),n.refreshOptions(n.isFocused&&!n.isInputHidden),n.loading||W(n.wrapper,n.settings.loadingClass),n.trigger("load",e,t)}preload(){var e=this.wrapper.classList;e.contains("preloaded")||(e.add("preloaded"),this.load(""))}setTextboxValue(e=""){var t=this.control_input;t.value!==e&&(t.value=e,U(t,"update"),this.lastValue=e)}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(e,t){Oe(this,t?[]:["change"],(()=>{this.clear(t),this.addItems(e,t)}))}setMaxItems(e){0===e&&(e=null),this.settings.maxItems=e,this.refreshState()}setActiveItem(e,t){var n,s,i,r,o,a,l=this;if("single"!==l.settings.mode){if(!e)return l.clearActiveItems(),void(l.isFocused&&l.inputState());if("click"===(n=t&&t.type.toLowerCase())&&Se("shiftKey",t)&&l.activeItems.length){for(a=l.getLastActive(),(i=Array.prototype.indexOf.call(l.control.children,a))>(r=Array.prototype.indexOf.call(l.control.children,e))&&(o=i,i=r,r=o),s=i;s<=r;s++)e=l.control.children[s],-1===l.activeItems.indexOf(e)&&l.setActiveItemClass(e);Ae(t)}else"click"===n&&Se(me,t)||"keydown"===n&&Se("shiftKey",t)?e.classList.contains("active")?l.removeActiveItem(e):l.setActiveItemClass(e):(l.clearActiveItems(),l.setActiveItemClass(e));l.inputState(),l.isFocused||l.focus()}}setActiveItemClass(e){const t=this,n=t.control.querySelector(".last-active");n&&W(n,"last-active"),z(e,"active last-active"),t.trigger("item_select",e),-1==t.activeItems.indexOf(e)&&t.activeItems.push(e)}removeActiveItem(e){var t=this.activeItems.indexOf(e);this.activeItems.splice(t,1),W(e,"active")}clearActiveItems(){W(this.activeItems,"active"),this.activeItems=[]}setActiveOption(e,t=!0){e!==this.activeOption&&(this.clearActiveOption(),e&&(this.activeOption=e,ee(this.focus_node,{"aria-activedescendant":e.getAttribute("id")}),ee(e,{"aria-selected":"true"}),z(e,"active"),t&&this.scrollToOption(e)))}scrollToOption(e,t){if(!e)return;const n=this.dropdown_content,s=n.clientHeight,i=n.scrollTop||0,r=e.offsetHeight,o=e.getBoundingClientRect().top-n.getBoundingClientRect().top+i;o+r>s+i?this.scroll(o-s+r,t):o<i&&this.scroll(o,t)}scroll(e,t){const n=this.dropdown_content;t&&(n.style.scrollBehavior=t),n.scrollTop=e,n.style.scrollBehavior=""}clearActiveOption(){this.activeOption&&(W(this.activeOption,"active"),ee(this.activeOption,{"aria-selected":null})),this.activeOption=null,ee(this.focus_node,{"aria-activedescendant":null})}selectAll(){const e=this;if("single"===e.settings.mode)return;const t=e.controlChildren();t.length&&(e.inputState(),e.close(),e.activeItems=t,D(t,(t=>{e.setActiveItemClass(t)})))}inputState(){var e=this;e.control.contains(e.control_input)&&(ee(e.control_input,{placeholder:e.settings.placeholder}),e.activeItems.length>0||!e.isFocused&&e.settings.hidePlaceholder&&e.items.length>0?(e.setTextboxValue(),e.isInputHidden=!0):(e.settings.hidePlaceholder&&e.items.length>0&&ee(e.control_input,{placeholder:""}),e.isInputHidden=!1),e.wrapper.classList.toggle("input-hidden",e.isInputHidden))}inputValue(){return this.control_input.value.trim()}focus(){var e=this;e.isDisabled||e.isReadOnly||(e.ignoreFocus=!0,e.control_input.offsetWidth?e.control_input.focus():e.focus_node.focus(),setTimeout((()=>{e.ignoreFocus=!1,e.onFocus()}),0))}blur(){this.focus_node.blur(),this.onBlur()}getScoreFunction(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())}getSearchOptions(){var e=this.settings,t=e.sortField;return"string"==typeof e.sortField&&(t=[{field:e.sortField}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:t,nesting:e.nesting}}search(e){var t,n,s=this,i=this.getSearchOptions();if(s.settings.score&&"function"!=typeof(n=s.settings.score.call(s,e)))throw new Error('Tom Select "score" setting must be a function that returns a function');return e!==s.lastQuery?(s.lastQuery=e,t=s.sifter.search(e,Object.assign(i,{score:n})),s.currentResults=t):t=Object.assign({},s.currentResults),s.settings.hideSelected&&(t.items=t.items.filter((e=>{let t=fe(e.id);return!(t&&-1!==s.items.indexOf(t))}))),t}refreshOptions(e=!0){var t,n,s,i,r,o,a,l,c,d;const h={},u=[];var p=this,m=p.inputValue();const g=m===p.lastQuery||""==m&&null==p.lastQuery;var f=p.search(m),v=null,b=p.settings.shouldOpen||!1,y=p.dropdown_content;g&&(v=p.activeOption)&&(c=v.closest("[data-group]")),i=f.items.length,"number"==typeof p.settings.maxOptions&&(i=Math.min(i,p.settings.maxOptions)),i>0&&(b=!0);const E=(e,t)=>{let n=h[e];if(void 0!==n){let e=u[n];if(void 0!==e)return[n,e.fragment]}let s=document.createDocumentFragment();return n=u.length,u.push({fragment:s,order:t,optgroup:e}),[n,s]};for(t=0;t<i;t++){let e=f.items[t];if(!e)continue;let i=e.id,a=p.options[i];if(void 0===a)continue;let l=ve(i),d=p.getOption(l,!0);for(p.settings.hideSelected||d.classList.toggle("selected",p.items.includes(l)),r=a[p.settings.optgroupField]||"",n=0,s=(o=Array.isArray(r)?r:[r])&&o.length;n<s;n++){r=o[n];let e=a.$order,t=p.optgroups[r];void 0===t?r="":e=t.$order;const[s,l]=E(r,e);n>0&&(d=d.cloneNode(!0),ee(d,{id:a.$id+"-clone-"+n,"aria-selected":null}),d.classList.add("ts-cloned"),W(d,"active"),p.activeOption&&p.activeOption.dataset.value==i&&c&&c.dataset.group===r.toString()&&(v=d)),l.appendChild(d),""!=r&&(h[r]=s)}}p.settings.lockOptgroupOrder&&u.sort(((e,t)=>e.order-t.order)),a=document.createDocumentFragment(),D(u,(e=>{let t=e.fragment,n=e.optgroup;if(!t||!t.children.length)return;let s=p.optgroups[n];if(void 0!==s){let e=document.createDocumentFragment(),n=p.render("optgroup_header",s);Te(e,n),Te(e,t);let i=p.render("optgroup",{group:s,options:e});Te(a,i)}else Te(a,t)})),y.innerHTML="",Te(y,a),p.settings.highlight&&(se(y),f.query.length&&f.tokens.length&&D(f.tokens,(e=>{ne(y,e.regex)})));var O=e=>{let t=p.render(e,{input:m});return t&&(b=!0,y.insertBefore(t,y.firstChild)),t};if(p.loading?O("loading"):p.settings.shouldLoad.call(p,m)?0===f.items.length&&O("no_results"):O("not_loading"),(l=p.canCreate(m))&&(d=O("option_create")),p.hasOptions=f.items.length>0||l,b){if(f.items.length>0){if(v||"single"!==p.settings.mode||null==p.items[0]||(v=p.getOption(p.items[0])),!y.contains(v)){let e=0;d&&!p.settings.addPrecedence&&(e=1),v=p.selectable()[e]}}else d&&(v=d);e&&!p.isOpen&&(p.open(),p.scrollToOption(v,"auto")),p.setActiveOption(v)}else p.clearActiveOption(),e&&p.isOpen&&p.close(!1)}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(e,t=!1){const n=this;if(Array.isArray(e))return n.addOptions(e,t),!1;const s=fe(e[n.settings.valueField]);return null!==s&&!n.options.hasOwnProperty(s)&&(e.$order=e.$order||++n.order,e.$id=n.inputId+"-opt-"+e.$order,n.options[s]=e,n.lastQuery=null,t&&(n.userOptions[s]=t,n.trigger("option_add",s,e)),s)}addOptions(e,t=!1){D(e,(e=>{this.addOption(e,t)}))}registerOption(e){return this.addOption(e)}registerOptionGroup(e){var t=fe(e[this.settings.optgroupValueField]);return null!==t&&(e.$order=e.$order||++this.order,this.optgroups[t]=e,t)}addOptionGroup(e,t){var n;t[this.settings.optgroupValueField]=e,(n=this.registerOptionGroup(t))&&this.trigger("optgroup_add",n,t)}removeOptionGroup(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.clearCache(),this.trigger("optgroup_remove",e))}clearOptionGroups(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")}updateOption(e,t){const n=this;var s,i;const r=fe(e),o=fe(t[n.settings.valueField]);if(null===r)return;const a=n.options[r];if(null==a)return;if("string"!=typeof o)throw new Error("Value must be set in option data");const l=n.getOption(r),c=n.getItem(r);if(t.$order=t.$order||a.$order,delete n.options[r],n.uncacheValue(o),n.options[o]=t,l){if(n.dropdown_content.contains(l)){const e=n._render("option",t);te(l,e),n.activeOption===l&&n.setActiveOption(e)}l.remove()}c&&(-1!==(i=n.items.indexOf(r))&&n.items.splice(i,1,o),s=n._render("item",t),c.classList.contains("active")&&z(s,"active"),te(c,s)),n.lastQuery=null}removeOption(e,t){const n=this;e=ve(e),n.uncacheValue(e),delete n.userOptions[e],delete n.options[e],n.lastQuery=null,n.trigger("option_remove",e),n.removeItem(e,t)}clearOptions(e){const t=(e||this.clearFilter).bind(this);this.loadedSearches={},this.userOptions={},this.clearCache();const n={};D(this.options,((e,s)=>{t(e,s)&&(n[s]=e)})),this.options=this.sifter.items=n,this.lastQuery=null,this.trigger("option_clear")}clearFilter(e,t){return this.items.indexOf(t)>=0}getOption(e,t=!1){const n=fe(e);if(null===n)return null;const s=this.options[n];if(null!=s){if(s.$div)return s.$div;if(t)return this._render("option",s)}return null}getAdjacent(e,t,n="option"){var s,i=this;if(!e)return null;s="item"==n?i.controlChildren():i.dropdown_content.querySelectorAll("[data-selectable]");for(let n=0;n<s.length;n++)if(s[n]==e)return t>0?s[n+1]:s[n-1];return null}getItem(e){if("object"==typeof e)return e;var t=fe(e);return null!==t?this.control.querySelector(`[data-value="${Me(t)}"]`):null}addItems(e,t){var n=this,s=Array.isArray(e)?e:[e];const i=(s=s.filter((e=>-1===n.items.indexOf(e))))[s.length-1];s.forEach((e=>{n.isPending=e!==i,n.addItem(e,t)}))}addItem(e,t){Oe(this,t?[]:["change","dropdown_close"],(()=>{var n,s;const i=this,r=i.settings.mode,o=fe(e);if((!o||-1===i.items.indexOf(o)||("single"===r&&i.close(),"single"!==r&&i.settings.duplicates))&&null!==o&&i.options.hasOwnProperty(o)&&("single"===r&&i.clear(t),"multi"!==r||!i.isFull())){if(n=i._render("item",i.options[o]),i.control.contains(n)&&(n=n.cloneNode(!0)),s=i.isFull(),i.items.splice(i.caretPos,0,o),i.insertAtCaret(n),i.isSetup){if(!i.isPending&&i.settings.hideSelected){let e=i.getOption(o),t=i.getAdjacent(e,1);t&&i.setActiveOption(t)}i.isPending||i.settings.closeAfterSelect||i.refreshOptions(i.isFocused&&"single"!==r),0!=i.settings.closeAfterSelect&&i.isFull()?i.close():i.isPending||i.positionDropdown(),i.trigger("item_add",o,n),i.isPending||i.updateOriginalInput({silent:t})}(!i.isPending||!s&&i.isFull())&&(i.inputState(),i.refreshState())}}))}removeItem(e=null,t){const n=this;if(!(e=n.getItem(e)))return;var s,i;const r=e.dataset.value;s=Z(e),e.remove(),e.classList.contains("active")&&(i=n.activeItems.indexOf(e),n.activeItems.splice(i,1),W(e,"active")),n.items.splice(s,1),n.lastQuery=null,!n.settings.persist&&n.userOptions.hasOwnProperty(r)&&n.removeOption(r,t),s<n.caretPos&&n.setCaret(n.caretPos-1),n.updateOriginalInput({silent:t}),n.refreshState(),n.positionDropdown(),n.trigger("item_remove",r,e)}createItem(e=null,t=()=>{}){3===arguments.length&&(t=arguments[2]),"function"!=typeof t&&(t=()=>{});var n,s=this,i=s.caretPos;if(e=e||s.inputValue(),!s.canCreate(e))return t(),!1;s.lock();var r=!1,o=e=>{if(s.unlock(),!e||"object"!=typeof e)return t();var n=fe(e[s.settings.valueField]);if("string"!=typeof n)return t();s.setTextboxValue(),s.addOption(e,!0),s.setCaret(i),s.addItem(n),t(e),r=!0};return n="function"==typeof s.settings.create?s.settings.create.call(this,e,o):{[s.settings.labelField]:e,[s.settings.valueField]:e},r||o(n),!0}refreshItems(){var e=this;e.lastQuery=null,e.isSetup&&e.addItems(e.items),e.updateOriginalInput(),e.refreshState()}refreshState(){const e=this;e.refreshValidityState();const t=e.isFull(),n=e.isLocked;e.wrapper.classList.toggle("rtl",e.rtl);const s=e.wrapper.classList;s.toggle("focus",e.isFocused),s.toggle("disabled",e.isDisabled),s.toggle("readonly",e.isReadOnly),s.toggle("required",e.isRequired),s.toggle("invalid",!e.isValid),s.toggle("locked",n),s.toggle("full",t),s.toggle("input-active",e.isFocused&&!e.isInputHidden),s.toggle("dropdown-active",e.isOpen),s.toggle("has-options",Y(e.options)),s.toggle("has-items",e.items.length>0)}refreshValidityState(){var e=this;e.input.validity&&(e.isValid=e.input.validity.valid,e.isInvalid=!e.isValid)}isFull(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems}updateOriginalInput(e={}){const t=this;var n,s;const i=t.input.querySelector('option[value=""]');if(t.is_select_tag){const r=[],o=t.input.querySelectorAll("option:checked").length;function a(e,n,s){return e||(e=R('<option value="'+be(n)+'">'+be(s)+"</option>")),e!=i&&t.input.append(e),r.push(e),(e!=i||o>0)&&(e.selected=!0),e}t.input.querySelectorAll("option:checked").forEach((e=>{e.selected=!1})),0==t.items.length&&"single"==t.settings.mode?a(i,"",""):t.items.forEach((e=>{n=t.options[e],s=n[t.settings.labelField]||"",r.includes(n.$option)?a(t.input.querySelector(`option[value="${Me(e)}"]:not(:checked)`),e,s):n.$option=a(n.$option,e,s)}))}else t.input.value=t.getValue();t.isSetup&&(e.silent||t.trigger("change",t.getValue()))}open(){var e=this;e.isLocked||e.isOpen||"multi"===e.settings.mode&&e.isFull()||(e.isOpen=!0,ee(e.focus_node,{"aria-expanded":"true"}),e.refreshState(),K(e.dropdown,{visibility:"hidden",display:"block"}),e.positionDropdown(),K(e.dropdown,{visibility:"visible",display:"block"}),e.focus(),e.trigger("dropdown_open",e.dropdown))}close(e=!0){var t=this,n=t.isOpen;e&&(t.setTextboxValue(),"single"===t.settings.mode&&t.items.length&&t.inputState()),t.isOpen=!1,ee(t.focus_node,{"aria-expanded":"false"}),K(t.dropdown,{display:"none"}),t.settings.hideSelected&&t.clearActiveOption(),t.refreshState(),n&&t.trigger("dropdown_close",t.dropdown)}positionDropdown(){if("body"===this.settings.dropdownParent){var e=this.control,t=e.getBoundingClientRect(),n=e.offsetHeight+t.top+window.scrollY,s=t.left+window.scrollX;K(this.dropdown,{width:t.width+"px",top:n+"px",left:s+"px"})}}clear(e){var t=this;if(t.items.length){var n=t.controlChildren();D(n,(e=>{t.removeItem(e,!0)})),t.inputState(),e||t.updateOriginalInput(),t.trigger("clear")}}insertAtCaret(e){const t=this,n=t.caretPos,s=t.control;s.insertBefore(e,s.children[n]||null),t.setCaret(n+1)}deleteSelection(e){var t,n,s,i,r=this;t=e&&e.keyCode===he?-1:1,n=we(r.control_input);const o=[];if(r.activeItems.length)i=X(r.activeItems,t),s=Z(i),t>0&&s++,D(r.activeItems,(e=>o.push(e)));else if((r.isFocused||"single"===r.settings.mode)&&r.items.length){const e=r.controlChildren();let s;t<0&&0===n.start&&0===n.length?s=e[r.caretPos-1]:t>0&&n.start===r.inputValue().length&&(s=e[r.caretPos]),void 0!==s&&o.push(s)}if(!r.shouldDelete(o,e))return!1;for(Ae(e,!0),void 0!==s&&r.setCaret(s);o.length;)r.removeItem(o.pop());return r.inputState(),r.positionDropdown(),r.refreshOptions(!1),!0}shouldDelete(e,t){const n=e.map((e=>e.dataset.value));return!(!n.length||"function"==typeof this.settings.onDelete&&!1===this.settings.onDelete(n,t))}advanceSelection(e,t){var n,s,i=this;i.rtl&&(e*=-1),i.inputValue().length||(Se(me,t)||Se("shiftKey",t)?(s=(n=i.getLastActive(e))?n.classList.contains("active")?i.getAdjacent(n,e,"item"):n:e>0?i.control_input.nextElementSibling:i.control_input.previousElementSibling)&&(s.classList.contains("active")&&i.removeActiveItem(n),i.setActiveItemClass(s)):i.moveCaret(e))}moveCaret(e){}getLastActive(e){let t=this.control.querySelector(".last-active");if(t)return t;var n=this.control.querySelectorAll(".active");return n?X(n,e):void 0}setCaret(e){this.caretPos=this.items.length}controlChildren(){return Array.from(this.control.querySelectorAll("[data-ts-item]"))}lock(){this.setLocked(!0)}unlock(){this.setLocked(!1)}setLocked(e=this.isReadOnly||this.isDisabled){this.isLocked=e,this.refreshState()}disable(){this.setDisabled(!0),this.close()}enable(){this.setDisabled(!1)}setDisabled(e){this.focus_node.tabIndex=e?-1:this.tabIndex,this.isDisabled=e,this.input.disabled=e,this.control_input.disabled=e,this.setLocked()}setReadOnly(e){this.isReadOnly=e,this.input.readOnly=e,this.control_input.readOnly=e,this.setLocked()}destroy(){var e=this,t=e.revertSettings;e.trigger("destroy"),e.off(),e.wrapper.remove(),e.dropdown.remove(),e.input.innerHTML=t.innerHTML,e.input.tabIndex=t.tabIndex,W(e.input,"tomselected","ts-hidden-accessible"),e._destroy(),delete e.input.tomselect}render(e,t){var n,s;const i=this;if("function"!=typeof this.settings.render[e])return null;if(!(s=i.settings.render[e].call(this,t,be)))return null;if(s=R(s),"option"===e||"option_create"===e?t[i.settings.disabledField]?ee(s,{"aria-disabled":"true"}):ee(s,{"data-selectable":""}):"optgroup"===e&&(n=t.group[i.settings.optgroupValueField],ee(s,{"data-group":n}),t.group[i.settings.disabledField]&&ee(s,{"data-disabled":""})),"option"===e||"item"===e){const n=ve(t[i.settings.valueField]);ee(s,{"data-value":n}),"item"===e?(z(s,i.settings.itemClass),ee(s,{"data-ts-item":""})):(z(s,i.settings.optionClass),ee(s,{role:"option",id:t.$id}),t.$div=s,i.options[n]=t)}return s}_render(e,t){const n=this.render(e,t);if(null==n)throw"HTMLElement expected";return n}clearCache(){D(this.options,(e=>{e.$div&&(e.$div.remove(),delete e.$div)}))}uncacheValue(e){const t=this.getOption(e);t&&t.remove()}canCreate(e){return this.settings.create&&e.length>0&&this.settings.createFilter.call(this,e)}hook(e,t,n){var s=this,i=s[t];s[t]=function(){var t,r;return"after"===e&&(t=i.apply(s,arguments)),r=n.apply(s,arguments),"instead"===e?r:("before"===e&&(t=i.apply(s,arguments)),t)}}}function Ne(){ke(this.input,"change",(()=>{this.sync()}))}function Le(e){var t=this,n=t.onOptionSelect;t.settings.hideSelected=!1;const s=Object.assign({className:"tomselect-checkbox",checkedClassNames:void 0,uncheckedClassNames:void 0},e);var i=function(e,t){t?(e.checked=!0,s.uncheckedClassNames&&e.classList.remove(...s.uncheckedClassNames),s.checkedClassNames&&e.classList.add(...s.checkedClassNames)):(e.checked=!1,s.checkedClassNames&&e.classList.remove(...s.checkedClassNames),s.uncheckedClassNames&&e.classList.add(...s.uncheckedClassNames))},r=function(e){setTimeout((()=>{var t=e.querySelector("input."+s.className);t instanceof HTMLInputElement&&i(t,e.classList.contains("selected"))}),1)};t.hook("after","setupTemplates",(()=>{var e=t.settings.render.option;t.settings.render.option=(n,r)=>{var o=R(e.call(t,n,r)),a=document.createElement("input");s.className&&a.classList.add(s.className),a.addEventListener("click",(function(e){Ae(e)})),a.type="checkbox";const l=fe(n[t.settings.valueField]);return i(a,!!(l&&t.items.indexOf(l)>-1)),o.prepend(a),o}})),t.on("item_remove",(e=>{var n=t.getOption(e);n&&(n.classList.remove("selected"),r(n))})),t.on("item_add",(e=>{var n=t.getOption(e);n&&r(n)})),t.hook("instead","onOptionSelect",((e,s)=>{if(s.classList.contains("selected"))return s.classList.remove("selected"),t.removeItem(s.dataset.value),t.refreshOptions(),void Ae(e,!0);n.call(t,e,s),r(s)}))}function Pe(e){const t=this,n=Object.assign({className:"clear-button",title:"Clear All",html:e=>`<div class="${e.className}" title="${e.title}">&#10799;</div>`},e);t.on("initialize",(()=>{var e=R(n.html(n));e.addEventListener("click",(e=>{t.isLocked||(t.clear(),"single"===t.settings.mode&&t.settings.allowEmptyOption&&t.addItem(""),e.preventDefault(),e.stopPropagation())})),t.control.appendChild(e)}))}const $e=(e,t)=>{var n;null==(n=e.parentNode)||n.insertBefore(t,e.nextSibling)},_e=(e,t)=>{var n;null==(n=e.parentNode)||n.insertBefore(t,e)},De=(e,t)=>{do{var n;if(e==(t=null==(n=t)?void 0:n.previousElementSibling))return!0}while(t&&t.previousElementSibling);return!1};function Ve(){var e=this;if("multi"!==e.settings.mode)return;var t=e.lock,n=e.unlock;let s,i=!0;e.hook("after","setupTemplates",(()=>{var t=e.settings.render.item;e.settings.render.item=(n,r)=>{const o=R(t.call(e,n,r));ee(o,{draggable:"true"});const a=e=>{s=o,setTimeout((()=>{o.classList.add("ts-dragging")}),0)},l=e=>{e.preventDefault(),o.classList.add("ts-drag-over"),d(o,s)},c=()=>{o.classList.remove("ts-drag-over")},d=(e,t)=>{void 0!==t&&(De(t,o)?$e(e,t):_e(e,t))},h=()=>{var t;document.querySelectorAll(".ts-drag-over").forEach((e=>e.classList.remove("ts-drag-over"))),null==(t=s)||t.classList.remove("ts-dragging"),s=void 0;var n=[];e.control.querySelectorAll("[data-value]").forEach((e=>{if(e.dataset.value){let t=e.dataset.value;t&&n.push(t)}})),e.setValue(n)};return ke(o,"mousedown",(e=>{i||Ae(e),e.stopPropagation()})),ke(o,"dragstart",a),ke(o,"dragenter",l),ke(o,"dragover",l),ke(o,"dragleave",c),ke(o,"dragend",h),o}})),e.hook("instead","lock",(()=>(i=!1,t.call(e)))),e.hook("instead","unlock",(()=>(i=!0,n.call(e))))}function je(e){const t=this,n=Object.assign({title:"Untitled",headerClass:"dropdown-header",titleRowClass:"dropdown-header-title",labelClass:"dropdown-header-label",closeClass:"dropdown-header-close",html:e=>'<div class="'+e.headerClass+'"><div class="'+e.titleRowClass+'"><span class="'+e.labelClass+'">'+e.title+'</span><a class="'+e.closeClass+'">&times;</a></div></div>'},e);t.on("initialize",(()=>{var e=R(n.html(n)),s=e.querySelector("."+n.closeClass);s&&s.addEventListener("click",(e=>{Ae(e,!0),t.close()})),t.dropdown.insertBefore(e,t.dropdown.firstChild)}))}function Be(){var e=this;e.hook("instead","setCaret",(t=>{"single"!==e.settings.mode&&e.control.contains(e.control_input)?(t=Math.max(0,Math.min(e.items.length,t)))==e.caretPos||e.isPending||e.controlChildren().forEach(((n,s)=>{s<t?e.control_input.insertAdjacentElement("beforebegin",n):e.control.appendChild(n)})):t=e.items.length,e.caretPos=t})),e.hook("instead","moveCaret",(t=>{if(!e.isFocused)return;const n=e.getLastActive(t);if(n){const s=Z(n);e.setCaret(t>0?s+1:s),e.setActiveItem(),W(n,"last-active")}else e.setCaret(e.caretPos+t)}))}function Re(){const e=this;e.settings.shouldOpen=!0,e.hook("before","setup",(()=>{e.focus_node=e.control,z(e.control_input,"dropdown-input");const t=R('<div class="dropdown-input-wrap">');t.append(e.control_input),e.dropdown.insertBefore(t,e.dropdown.firstChild);const n=R('<input class="items-placeholder" tabindex="-1" />');n.placeholder=e.settings.placeholder||"",e.control.append(n)})),e.on("initialize",(()=>{e.control_input.addEventListener("keydown",(t=>{switch(t.keyCode){case oe:return e.isOpen&&(Ae(t,!0),e.close()),void e.clearActiveItems();case pe:e.focus_node.tabIndex=-1}return e.onKeyDown.call(e,t)})),e.on("blur",(()=>{e.focus_node.tabIndex=e.isDisabled?-1:e.tabIndex})),e.on("dropdown_open",(()=>{e.control_input.focus()}));const t=e.onBlur;e.hook("instead","onBlur",(n=>{if(!n||n.relatedTarget!=e.control_input)return t.call(e)})),ke(e.control_input,"blur",(()=>e.onBlur())),e.hook("before","close",(()=>{e.isOpen&&e.focus_node.focus({preventScroll:!0})}))}))}function qe(){var e=this;e.on("initialize",(()=>{var t=document.createElement("span"),n=e.control_input;t.style.cssText="position:absolute; top:-99999px; left:-99999px; width:auto; padding:0; white-space:pre; ",e.wrapper.appendChild(t);var s=["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"];for(const e of s)t.style[e]=n.style[e];var i=()=>{t.textContent=n.value,n.style.width=t.clientWidth+"px"};i(),e.on("update item_add item_remove",i),ke(n,"input",i),ke(n,"keyup",i),ke(n,"blur",i),ke(n,"update",i)}))}function He(){var e=this,t=e.deleteSelection;this.hook("instead","deleteSelection",(n=>!!e.activeItems.length&&t.call(e,n)))}function Ue(){this.hook("instead","setActiveItem",(()=>{})),this.hook("instead","selectAll",(()=>{}))}function Ke(){var e=this,t=e.onKeyDown;e.hook("instead","onKeyDown",(n=>{var s,i,r,o;if(!e.isOpen||n.keyCode!==ae&&n.keyCode!==ce)return t.call(e,n);e.ignoreHover=!0,o=Q(e.activeOption,"[data-group]"),s=Z(e.activeOption,"[data-selectable]"),o&&(o=n.keyCode===ae?o.previousSibling:o.nextSibling)&&(i=(r=o.querySelectorAll("[data-selectable]"))[Math.min(r.length-1,s)])&&e.setActiveOption(i)}))}function ze(e){const t=Object.assign({label:"&times;",title:"Remove",className:"remove",append:!0},e);var n=this;if(t.append){var s='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+be(t.title)+'">'+t.label+"</a>";n.hook("after","setupTemplates",(()=>{var e=n.settings.render.item;n.settings.render.item=(t,i)=>{var r=R(e.call(n,t,i)),o=R(s);return r.appendChild(o),ke(o,"mousedown",(e=>{Ae(e,!0)})),ke(o,"click",(e=>{n.isLocked||(Ae(e,!0),n.isLocked||n.shouldDelete([r],e)&&(n.removeItem(r),n.refreshOptions(!1),n.inputState()))})),r}}))}}function We(e){const t=this,n=Object.assign({text:e=>e[t.settings.labelField]},e);t.on("item_remove",(function(e){if(t.isFocused&&""===t.control_input.value.trim()){var s=t.options[e];s&&t.setTextboxValue(n.text.call(t,s))}}))}function Je(){const e=this,t=e.canLoad,n=e.clearActiveOption,s=e.loadCallback;var i,r,o={},a=!1,l=[];if(e.settings.shouldLoadMore||(e.settings.shouldLoadMore=()=>{if(i.clientHeight/(i.scrollHeight-i.scrollTop)>.9)return!0;if(e.activeOption){var t=e.selectable();if(Array.from(t).indexOf(e.activeOption)>=t.length-2)return!0}return!1}),!e.settings.firstUrl)throw"virtual_scroll plugin requires a firstUrl() method";e.settings.sortField=[{field:"$order"},{field:"$score"}];const c=t=>!("number"==typeof e.settings.maxOptions&&i.children.length>=e.settings.maxOptions||!(t in o)||!o[t]),d=(t,n)=>e.items.indexOf(n)>=0||l.indexOf(n)>=0;e.setNextUrl=(e,t)=>{o[e]=t},e.getUrl=t=>{if(t in o){const e=o[t];return o[t]=!1,e}return e.clearPagination(),e.settings.firstUrl.call(e,t)},e.clearPagination=()=>{o={}},e.hook("instead","clearActiveOption",(()=>{if(!a)return n.call(e)})),e.hook("instead","canLoad",(n=>n in o?c(n):t.call(e,n))),e.hook("instead","loadCallback",((t,n)=>{if(a){if(r){const n=t[0];void 0!==n&&(r.dataset.value=n[e.settings.valueField])}}else e.clearOptions(d);s.call(e,t,n),a=!1})),e.hook("after","refreshOptions",(()=>{const t=e.lastValue;var n;c(t)?(n=e.render("loading_more",{query:t}))&&(n.setAttribute("data-selectable",""),r=n):t in o&&!i.querySelector(".no-results")&&(n=e.render("no_more_results",{query:t})),n&&(z(n,e.settings.optionClass),i.append(n))})),e.on("initialize",(()=>{l=Object.keys(e.options),i=e.dropdown_content,e.settings.render=Object.assign({},{loading_more:()=>'<div class="loading-more-results">Loading more results ... </div>',no_more_results:()=>'<div class="no-more-results">No more results</div>'},e.settings.render),i.addEventListener("scroll",(()=>{e.settings.shouldLoadMore.call(e)&&c(e.lastValue)&&(a||(a=!0,e.load.call(e,e.lastValue)))}))}))}return Ie.define("change_listener",Ne),Ie.define("checkbox_options",Le),Ie.define("clear_button",Pe),Ie.define("drag_drop",Ve),Ie.define("dropdown_header",je),Ie.define("caret_position",Be),Ie.define("dropdown_input",Re),Ie.define("input_autogrow",qe),Ie.define("no_backspace_delete",He),Ie.define("no_active_items",Ue),Ie.define("optgroup_columns",Ke),Ie.define("remove_button",ze),Ie.define("restore_on_backspace",We),Ie.define("virtual_scroll",Je),Ie}()}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";class e{constructor(e,t,n){this.eventTarget=e,this.eventName=t,this.eventOptions=n,this.unorderedBindings=new Set}connect(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}disconnect(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}bindingConnected(e){this.unorderedBindings.add(e)}bindingDisconnected(e){this.unorderedBindings.delete(e)}handleEvent(e){const t=function(e){if("immediatePropagationStopped"in e)return e;{const{stopImmediatePropagation:t}=e;return Object.assign(e,{immediatePropagationStopped:!1,stopImmediatePropagation(){this.immediatePropagationStopped=!0,t.call(this)}})}}(e);for(const e of this.bindings){if(t.immediatePropagationStopped)break;e.handleEvent(t)}}hasBindings(){return this.unorderedBindings.size>0}get bindings(){return Array.from(this.unorderedBindings).sort(((e,t)=>{const n=e.index,s=t.index;return n<s?-1:n>s?1:0}))}}class t{constructor(e){this.application=e,this.eventListenerMaps=new Map,this.started=!1}start(){this.started||(this.started=!0,this.eventListeners.forEach((e=>e.connect())))}stop(){this.started&&(this.started=!1,this.eventListeners.forEach((e=>e.disconnect())))}get eventListeners(){return Array.from(this.eventListenerMaps.values()).reduce(((e,t)=>e.concat(Array.from(t.values()))),[])}bindingConnected(e){this.fetchEventListenerForBinding(e).bindingConnected(e)}bindingDisconnected(e,t=!1){this.fetchEventListenerForBinding(e).bindingDisconnected(e),t&&this.clearEventListenersForBinding(e)}handleError(e,t,n={}){this.application.handleError(e,`Error ${t}`,n)}clearEventListenersForBinding(e){const t=this.fetchEventListenerForBinding(e);t.hasBindings()||(t.disconnect(),this.removeMappedEventListenerFor(e))}removeMappedEventListenerFor(e){const{eventTarget:t,eventName:n,eventOptions:s}=e,i=this.fetchEventListenerMapForEventTarget(t),r=this.cacheKey(n,s);i.delete(r),0==i.size&&this.eventListenerMaps.delete(t)}fetchEventListenerForBinding(e){const{eventTarget:t,eventName:n,eventOptions:s}=e;return this.fetchEventListener(t,n,s)}fetchEventListener(e,t,n){const s=this.fetchEventListenerMapForEventTarget(e),i=this.cacheKey(t,n);let r=s.get(i);return r||(r=this.createEventListener(e,t,n),s.set(i,r)),r}createEventListener(t,n,s){const i=new e(t,n,s);return this.started&&i.connect(),i}fetchEventListenerMapForEventTarget(e){let t=this.eventListenerMaps.get(e);return t||(t=new Map,this.eventListenerMaps.set(e,t)),t}cacheKey(e,t){const n=[e];return Object.keys(t).sort().forEach((e=>{n.push(`${t[e]?"":"!"}${e}`)})),n.join(":")}}const s={stop:({event:e,value:t})=>(t&&e.stopPropagation(),!0),prevent:({event:e,value:t})=>(t&&e.preventDefault(),!0),self:({event:e,value:t,element:n})=>!t||n===e.target},i=/^(?:(?:([^.]+?)\+)?(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;function r(e){return"window"==e?window:"document"==e?document:void 0}function o(e){return e.replace(/(?:[_-])([a-z0-9])/g,((e,t)=>t.toUpperCase()))}function a(e){return o(e.replace(/--/g,"-").replace(/__/g,"_"))}function l(e){return e.charAt(0).toUpperCase()+e.slice(1)}function c(e){return e.replace(/([A-Z])/g,((e,t)=>`-${t.toLowerCase()}`))}function d(e){return null!=e}function h(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const u=["meta","ctrl","alt","shift"];class p{constructor(e,t,n,s){this.element=e,this.index=t,this.eventTarget=n.eventTarget||e,this.eventName=n.eventName||function(e){const t=e.tagName.toLowerCase();if(t in m)return m[t](e)}(e)||g("missing event name"),this.eventOptions=n.eventOptions||{},this.identifier=n.identifier||g("missing identifier"),this.methodName=n.methodName||g("missing method name"),this.keyFilter=n.keyFilter||"",this.schema=s}static forToken(e,t){return new this(e.element,e.index,function(e){const t=e.trim().match(i)||[];let n=t[2],s=t[3];return s&&!["keydown","keyup","keypress"].includes(n)&&(n+=`.${s}`,s=""),{eventTarget:r(t[4]),eventName:n,eventOptions:t[7]?(o=t[7],o.split(":").reduce(((e,t)=>Object.assign(e,{[t.replace(/^!/,"")]:!/^!/.test(t)})),{})):{},identifier:t[5],methodName:t[6],keyFilter:t[1]||s};var o}(e.content),t)}toString(){const e=this.keyFilter?`.${this.keyFilter}`:"",t=this.eventTargetName?`@${this.eventTargetName}`:"";return`${this.eventName}${e}${t}->${this.identifier}#${this.methodName}`}shouldIgnoreKeyboardEvent(e){if(!this.keyFilter)return!1;const t=this.keyFilter.split("+");if(this.keyFilterDissatisfied(e,t))return!0;const n=t.filter((e=>!u.includes(e)))[0];return!!n&&(h(this.keyMappings,n)||g(`contains unknown key filter: ${this.keyFilter}`),this.keyMappings[n].toLowerCase()!==e.key.toLowerCase())}shouldIgnoreMouseEvent(e){if(!this.keyFilter)return!1;const t=[this.keyFilter];return!!this.keyFilterDissatisfied(e,t)}get params(){const e={},t=new RegExp(`^data-${this.identifier}-(.+)-param$`,"i");for(const{name:n,value:s}of Array.from(this.element.attributes)){const i=n.match(t),r=i&&i[1];r&&(e[o(r)]=f(s))}return e}get eventTargetName(){return(e=this.eventTarget)==window?"window":e==document?"document":void 0;var e}get keyMappings(){return this.schema.keyMappings}keyFilterDissatisfied(e,t){const[n,s,i,r]=u.map((e=>t.includes(e)));return e.metaKey!==n||e.ctrlKey!==s||e.altKey!==i||e.shiftKey!==r}}const m={a:()=>"click",button:()=>"click",form:()=>"submit",details:()=>"toggle",input:e=>"submit"==e.getAttribute("type")?"click":"input",select:()=>"change",textarea:()=>"input"};function g(e){throw new Error(e)}function f(e){try{return JSON.parse(e)}catch(t){return e}}class v{constructor(e,t){this.context=e,this.action=t}get index(){return this.action.index}get eventTarget(){return this.action.eventTarget}get eventOptions(){return this.action.eventOptions}get identifier(){return this.context.identifier}handleEvent(e){const t=this.prepareActionEvent(e);this.willBeInvokedByEvent(e)&&this.applyEventModifiers(t)&&this.invokeWithEvent(t)}get eventName(){return this.action.eventName}get method(){const e=this.controller[this.methodName];if("function"==typeof e)return e;throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`)}applyEventModifiers(e){const{element:t}=this.action,{actionDescriptorFilters:n}=this.context.application,{controller:s}=this.context;let i=!0;for(const[r,o]of Object.entries(this.eventOptions))if(r in n){const a=n[r];i=i&&a({name:r,value:o,event:e,element:t,controller:s})}return i}prepareActionEvent(e){return Object.assign(e,{params:this.action.params})}invokeWithEvent(e){const{target:t,currentTarget:n}=e;try{this.method.call(this.controller,e),this.context.logDebugActivity(this.methodName,{event:e,target:t,currentTarget:n,action:this.methodName})}catch(t){const{identifier:n,controller:s,element:i,index:r}=this,o={identifier:n,controller:s,element:i,index:r,event:e};this.context.handleError(t,`invoking action "${this.action}"`,o)}}willBeInvokedByEvent(e){const t=e.target;return!(e instanceof KeyboardEvent&&this.action.shouldIgnoreKeyboardEvent(e))&&(!(e instanceof MouseEvent&&this.action.shouldIgnoreMouseEvent(e))&&(this.element===t||(t instanceof Element&&this.element.contains(t)?this.scope.containsElement(t):this.scope.containsElement(this.action.element))))}get controller(){return this.context.controller}get methodName(){return this.action.methodName}get element(){return this.scope.element}get scope(){return this.context.scope}}class b{constructor(e,t){this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=e,this.started=!1,this.delegate=t,this.elements=new Set,this.mutationObserver=new MutationObserver((e=>this.processMutations(e)))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}pause(e){this.started&&(this.mutationObserver.disconnect(),this.started=!1),e(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started){const e=new Set(this.matchElementsInTree());for(const t of Array.from(this.elements))e.has(t)||this.removeElement(t);for(const t of Array.from(e))this.addElement(t)}}processMutations(e){if(this.started)for(const t of e)this.processMutation(t)}processMutation(e){"attributes"==e.type?this.processAttributeChange(e.target,e.attributeName):"childList"==e.type&&(this.processRemovedNodes(e.removedNodes),this.processAddedNodes(e.addedNodes))}processAttributeChange(e,t){this.elements.has(e)?this.delegate.elementAttributeChanged&&this.matchElement(e)?this.delegate.elementAttributeChanged(e,t):this.removeElement(e):this.matchElement(e)&&this.addElement(e)}processRemovedNodes(e){for(const t of Array.from(e)){const e=this.elementFromNode(t);e&&this.processTree(e,this.removeElement)}}processAddedNodes(e){for(const t of Array.from(e)){const e=this.elementFromNode(t);e&&this.elementIsActive(e)&&this.processTree(e,this.addElement)}}matchElement(e){return this.delegate.matchElement(e)}matchElementsInTree(e=this.element){return this.delegate.matchElementsInTree(e)}processTree(e,t){for(const n of this.matchElementsInTree(e))t.call(this,n)}elementFromNode(e){if(e.nodeType==Node.ELEMENT_NODE)return e}elementIsActive(e){return e.isConnected==this.element.isConnected&&this.element.contains(e)}addElement(e){this.elements.has(e)||this.elementIsActive(e)&&(this.elements.add(e),this.delegate.elementMatched&&this.delegate.elementMatched(e))}removeElement(e){this.elements.has(e)&&(this.elements.delete(e),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(e))}}class y{constructor(e,t,n){this.attributeName=t,this.delegate=n,this.elementObserver=new b(e,this)}get element(){return this.elementObserver.element}get selector(){return`[${this.attributeName}]`}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get started(){return this.elementObserver.started}matchElement(e){return e.hasAttribute(this.attributeName)}matchElementsInTree(e){const t=this.matchElement(e)?[e]:[],n=Array.from(e.querySelectorAll(this.selector));return t.concat(n)}elementMatched(e){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(e,this.attributeName)}elementUnmatched(e){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(e,this.attributeName)}elementAttributeChanged(e,t){this.delegate.elementAttributeValueChanged&&this.attributeName==t&&this.delegate.elementAttributeValueChanged(e,t)}}function E(e,t,n){w(e,t).add(n)}function O(e,t,n){w(e,t).delete(n),function(e,t){const n=e.get(t);null!=n&&0==n.size&&e.delete(t)}(e,t)}function w(e,t){let n=e.get(t);return n||(n=new Set,e.set(t,n)),n}class A{constructor(){this.valuesByKey=new Map}get keys(){return Array.from(this.valuesByKey.keys())}get values(){return Array.from(this.valuesByKey.values()).reduce(((e,t)=>e.concat(Array.from(t))),[])}get size(){return Array.from(this.valuesByKey.values()).reduce(((e,t)=>e+t.size),0)}add(e,t){E(this.valuesByKey,e,t)}delete(e,t){O(this.valuesByKey,e,t)}has(e,t){const n=this.valuesByKey.get(e);return null!=n&&n.has(t)}hasKey(e){return this.valuesByKey.has(e)}hasValue(e){return Array.from(this.valuesByKey.values()).some((t=>t.has(e)))}getValuesForKey(e){const t=this.valuesByKey.get(e);return t?Array.from(t):[]}getKeysForValue(e){return Array.from(this.valuesByKey).filter((([t,n])=>n.has(e))).map((([e,t])=>e))}}class k{constructor(e,t,n,s){this._selector=t,this.details=s,this.elementObserver=new b(e,this),this.delegate=n,this.matchesByElement=new A}get started(){return this.elementObserver.started}get selector(){return this._selector}set selector(e){this._selector=e,this.refresh()}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get element(){return this.elementObserver.element}matchElement(e){const{selector:t}=this;if(t){const n=e.matches(t);return this.delegate.selectorMatchElement?n&&this.delegate.selectorMatchElement(e,this.details):n}return!1}matchElementsInTree(e){const{selector:t}=this;if(t){const n=this.matchElement(e)?[e]:[],s=Array.from(e.querySelectorAll(t)).filter((e=>this.matchElement(e)));return n.concat(s)}return[]}elementMatched(e){const{selector:t}=this;t&&this.selectorMatched(e,t)}elementUnmatched(e){const t=this.matchesByElement.getKeysForValue(e);for(const n of t)this.selectorUnmatched(e,n)}elementAttributeChanged(e,t){const{selector:n}=this;if(n){const t=this.matchElement(e),s=this.matchesByElement.has(n,e);t&&!s?this.selectorMatched(e,n):!t&&s&&this.selectorUnmatched(e,n)}}selectorMatched(e,t){this.delegate.selectorMatched(e,t,this.details),this.matchesByElement.add(t,e)}selectorUnmatched(e,t){this.delegate.selectorUnmatched(e,t,this.details),this.matchesByElement.delete(t,e)}}class S{constructor(e,t){this.element=e,this.delegate=t,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver((e=>this.processMutations(e)))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started)for(const e of this.knownAttributeNames)this.refreshAttribute(e,null)}processMutations(e){if(this.started)for(const t of e)this.processMutation(t)}processMutation(e){const t=e.attributeName;t&&this.refreshAttribute(t,e.oldValue)}refreshAttribute(e,t){const n=this.delegate.getStringMapKeyForAttribute(e);if(null!=n){this.stringMap.has(e)||this.stringMapKeyAdded(n,e);const s=this.element.getAttribute(e);if(this.stringMap.get(e)!=s&&this.stringMapValueChanged(s,n,t),null==s){const t=this.stringMap.get(e);this.stringMap.delete(e),t&&this.stringMapKeyRemoved(n,e,t)}else this.stringMap.set(e,s)}}stringMapKeyAdded(e,t){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(e,t)}stringMapValueChanged(e,t,n){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(e,t,n)}stringMapKeyRemoved(e,t,n){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(e,t,n)}get knownAttributeNames(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}get currentAttributeNames(){return Array.from(this.element.attributes).map((e=>e.name))}get recordedAttributeNames(){return Array.from(this.stringMap.keys())}}class C{constructor(e,t,n){this.attributeObserver=new y(e,t,this),this.delegate=n,this.tokensByElement=new A}get started(){return this.attributeObserver.started}start(){this.attributeObserver.start()}pause(e){this.attributeObserver.pause(e)}stop(){this.attributeObserver.stop()}refresh(){this.attributeObserver.refresh()}get element(){return this.attributeObserver.element}get attributeName(){return this.attributeObserver.attributeName}elementMatchedAttribute(e){this.tokensMatched(this.readTokensForElement(e))}elementAttributeValueChanged(e){const[t,n]=this.refreshTokensForElement(e);this.tokensUnmatched(t),this.tokensMatched(n)}elementUnmatchedAttribute(e){this.tokensUnmatched(this.tokensByElement.getValuesForKey(e))}tokensMatched(e){e.forEach((e=>this.tokenMatched(e)))}tokensUnmatched(e){e.forEach((e=>this.tokenUnmatched(e)))}tokenMatched(e){this.delegate.tokenMatched(e),this.tokensByElement.add(e.element,e)}tokenUnmatched(e){this.delegate.tokenUnmatched(e),this.tokensByElement.delete(e.element,e)}refreshTokensForElement(e){const t=this.tokensByElement.getValuesForKey(e),n=this.readTokensForElement(e),s=function(e,t){const n=Math.max(e.length,t.length);return Array.from({length:n},((n,s)=>[e[s],t[s]]))}(t,n).findIndex((([e,t])=>{return s=t,!((n=e)&&s&&n.index==s.index&&n.content==s.content);var n,s}));return-1==s?[[],[]]:[t.slice(s),n.slice(s)]}readTokensForElement(e){const t=this.attributeName;return function(e,t,n){return e.trim().split(/\s+/).filter((e=>e.length)).map(((e,s)=>({element:t,attributeName:n,content:e,index:s})))}(e.getAttribute(t)||"",e,t)}}class M{constructor(e,t,n){this.tokenListObserver=new C(e,t,this),this.delegate=n,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}get started(){return this.tokenListObserver.started}start(){this.tokenListObserver.start()}stop(){this.tokenListObserver.stop()}refresh(){this.tokenListObserver.refresh()}get element(){return this.tokenListObserver.element}get attributeName(){return this.tokenListObserver.attributeName}tokenMatched(e){const{element:t}=e,{value:n}=this.fetchParseResultForToken(e);n&&(this.fetchValuesByTokenForElement(t).set(e,n),this.delegate.elementMatchedValue(t,n))}tokenUnmatched(e){const{element:t}=e,{value:n}=this.fetchParseResultForToken(e);n&&(this.fetchValuesByTokenForElement(t).delete(e),this.delegate.elementUnmatchedValue(t,n))}fetchParseResultForToken(e){let t=this.parseResultsByToken.get(e);return t||(t=this.parseToken(e),this.parseResultsByToken.set(e,t)),t}fetchValuesByTokenForElement(e){let t=this.valuesByTokenByElement.get(e);return t||(t=new Map,this.valuesByTokenByElement.set(e,t)),t}parseToken(e){try{return{value:this.delegate.parseValueForToken(e)}}catch(e){return{error:e}}}}class T{constructor(e,t){this.context=e,this.delegate=t,this.bindingsByAction=new Map}start(){this.valueListObserver||(this.valueListObserver=new M(this.element,this.actionAttribute,this),this.valueListObserver.start())}stop(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}get element(){return this.context.element}get identifier(){return this.context.identifier}get actionAttribute(){return this.schema.actionAttribute}get schema(){return this.context.schema}get bindings(){return Array.from(this.bindingsByAction.values())}connectAction(e){const t=new v(this.context,e);this.bindingsByAction.set(e,t),this.delegate.bindingConnected(t)}disconnectAction(e){const t=this.bindingsByAction.get(e);t&&(this.bindingsByAction.delete(e),this.delegate.bindingDisconnected(t))}disconnectAllActions(){this.bindings.forEach((e=>this.delegate.bindingDisconnected(e,!0))),this.bindingsByAction.clear()}parseValueForToken(e){const t=p.forToken(e,this.schema);if(t.identifier==this.identifier)return t}elementMatchedValue(e,t){this.connectAction(t)}elementUnmatchedValue(e,t){this.disconnectAction(t)}}class F{constructor(e,t){this.context=e,this.receiver=t,this.stringMapObserver=new S(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap}start(){this.stringMapObserver.start(),this.invokeChangedCallbacksForDefaultValues()}stop(){this.stringMapObserver.stop()}get element(){return this.context.element}get controller(){return this.context.controller}getStringMapKeyForAttribute(e){if(e in this.valueDescriptorMap)return this.valueDescriptorMap[e].name}stringMapKeyAdded(e,t){const n=this.valueDescriptorMap[t];this.hasValue(e)||this.invokeChangedCallback(e,n.writer(this.receiver[e]),n.writer(n.defaultValue))}stringMapValueChanged(e,t,n){const s=this.valueDescriptorNameMap[t];null!==e&&(null===n&&(n=s.writer(s.defaultValue)),this.invokeChangedCallback(t,e,n))}stringMapKeyRemoved(e,t,n){const s=this.valueDescriptorNameMap[e];this.hasValue(e)?this.invokeChangedCallback(e,s.writer(this.receiver[e]),n):this.invokeChangedCallback(e,s.writer(s.defaultValue),n)}invokeChangedCallbacksForDefaultValues(){for(const{key:e,name:t,defaultValue:n,writer:s}of this.valueDescriptors)null==n||this.controller.data.has(e)||this.invokeChangedCallback(t,s(n),void 0)}invokeChangedCallback(e,t,n){const s=`${e}Changed`,i=this.receiver[s];if("function"==typeof i){const s=this.valueDescriptorNameMap[e];try{const e=s.reader(t);let r=n;n&&(r=s.reader(n)),i.call(this.receiver,e,r)}catch(e){throw e instanceof TypeError&&(e.message=`Stimulus Value "${this.context.identifier}.${s.name}" - ${e.message}`),e}}}get valueDescriptors(){const{valueDescriptorMap:e}=this;return Object.keys(e).map((t=>e[t]))}get valueDescriptorNameMap(){const e={};return Object.keys(this.valueDescriptorMap).forEach((t=>{const n=this.valueDescriptorMap[t];e[n.name]=n})),e}hasValue(e){const t=`has${l(this.valueDescriptorNameMap[e].name)}`;return this.receiver[t]}}class x{constructor(e,t){this.context=e,this.delegate=t,this.targetsByName=new A}start(){this.tokenListObserver||(this.tokenListObserver=new C(this.element,this.attributeName,this),this.tokenListObserver.start())}stop(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}tokenMatched({element:e,content:t}){this.scope.containsElement(e)&&this.connectTarget(e,t)}tokenUnmatched({element:e,content:t}){this.disconnectTarget(e,t)}connectTarget(e,t){var n;this.targetsByName.has(t,e)||(this.targetsByName.add(t,e),null===(n=this.tokenListObserver)||void 0===n||n.pause((()=>this.delegate.targetConnected(e,t))))}disconnectTarget(e,t){var n;this.targetsByName.has(t,e)&&(this.targetsByName.delete(t,e),null===(n=this.tokenListObserver)||void 0===n||n.pause((()=>this.delegate.targetDisconnected(e,t))))}disconnectAllTargets(){for(const e of this.targetsByName.keys)for(const t of this.targetsByName.getValuesForKey(e))this.disconnectTarget(t,e)}get attributeName(){return`data-${this.context.identifier}-target`}get element(){return this.context.element}get scope(){return this.context.scope}}function I(e,t){const n=L(e);return Array.from(n.reduce(((e,n)=>(function(e,t){const n=e[t];return Array.isArray(n)?n:[]}(n,t).forEach((t=>e.add(t))),e)),new Set))}function N(e,t){return L(e).reduce(((e,n)=>(e.push(...function(e,t){const n=e[t];return n?Object.keys(n).map((e=>[e,n[e]])):[]}(n,t)),e)),[])}function L(e){const t=[];for(;e;)t.push(e),e=Object.getPrototypeOf(e);return t.reverse()}class P{constructor(e,t){this.started=!1,this.context=e,this.delegate=t,this.outletsByName=new A,this.outletElementsByName=new A,this.selectorObserverMap=new Map,this.attributeObserverMap=new Map}start(){this.started||(this.outletDefinitions.forEach((e=>{this.setupSelectorObserverForOutlet(e),this.setupAttributeObserverForOutlet(e)})),this.started=!0,this.dependentContexts.forEach((e=>e.refresh())))}refresh(){this.selectorObserverMap.forEach((e=>e.refresh())),this.attributeObserverMap.forEach((e=>e.refresh()))}stop(){this.started&&(this.started=!1,this.disconnectAllOutlets(),this.stopSelectorObservers(),this.stopAttributeObservers())}stopSelectorObservers(){this.selectorObserverMap.size>0&&(this.selectorObserverMap.forEach((e=>e.stop())),this.selectorObserverMap.clear())}stopAttributeObservers(){this.attributeObserverMap.size>0&&(this.attributeObserverMap.forEach((e=>e.stop())),this.attributeObserverMap.clear())}selectorMatched(e,t,{outletName:n}){const s=this.getOutlet(e,n);s&&this.connectOutlet(s,e,n)}selectorUnmatched(e,t,{outletName:n}){const s=this.getOutletFromMap(e,n);s&&this.disconnectOutlet(s,e,n)}selectorMatchElement(e,{outletName:t}){const n=this.selector(t),s=this.hasOutlet(e,t),i=e.matches(`[${this.schema.controllerAttribute}~=${t}]`);return!!n&&(s&&i&&e.matches(n))}elementMatchedAttribute(e,t){const n=this.getOutletNameFromOutletAttributeName(t);n&&this.updateSelectorObserverForOutlet(n)}elementAttributeValueChanged(e,t){const n=this.getOutletNameFromOutletAttributeName(t);n&&this.updateSelectorObserverForOutlet(n)}elementUnmatchedAttribute(e,t){const n=this.getOutletNameFromOutletAttributeName(t);n&&this.updateSelectorObserverForOutlet(n)}connectOutlet(e,t,n){var s;this.outletElementsByName.has(n,t)||(this.outletsByName.add(n,e),this.outletElementsByName.add(n,t),null===(s=this.selectorObserverMap.get(n))||void 0===s||s.pause((()=>this.delegate.outletConnected(e,t,n))))}disconnectOutlet(e,t,n){var s;this.outletElementsByName.has(n,t)&&(this.outletsByName.delete(n,e),this.outletElementsByName.delete(n,t),null===(s=this.selectorObserverMap.get(n))||void 0===s||s.pause((()=>this.delegate.outletDisconnected(e,t,n))))}disconnectAllOutlets(){for(const e of this.outletElementsByName.keys)for(const t of this.outletElementsByName.getValuesForKey(e))for(const n of this.outletsByName.getValuesForKey(e))this.disconnectOutlet(n,t,e)}updateSelectorObserverForOutlet(e){const t=this.selectorObserverMap.get(e);t&&(t.selector=this.selector(e))}setupSelectorObserverForOutlet(e){const t=this.selector(e),n=new k(document.body,t,this,{outletName:e});this.selectorObserverMap.set(e,n),n.start()}setupAttributeObserverForOutlet(e){const t=this.attributeNameForOutletName(e),n=new y(this.scope.element,t,this);this.attributeObserverMap.set(e,n),n.start()}selector(e){return this.scope.outlets.getSelectorForOutletName(e)}attributeNameForOutletName(e){return this.scope.schema.outletAttributeForScope(this.identifier,e)}getOutletNameFromOutletAttributeName(e){return this.outletDefinitions.find((t=>this.attributeNameForOutletName(t)===e))}get outletDependencies(){const e=new A;return this.router.modules.forEach((t=>{I(t.definition.controllerConstructor,"outlets").forEach((n=>e.add(n,t.identifier)))})),e}get outletDefinitions(){return this.outletDependencies.getKeysForValue(this.identifier)}get dependentControllerIdentifiers(){return this.outletDependencies.getValuesForKey(this.identifier)}get dependentContexts(){const e=this.dependentControllerIdentifiers;return this.router.contexts.filter((t=>e.includes(t.identifier)))}hasOutlet(e,t){return!!this.getOutlet(e,t)||!!this.getOutletFromMap(e,t)}getOutlet(e,t){return this.application.getControllerForElementAndIdentifier(e,t)}getOutletFromMap(e,t){return this.outletsByName.getValuesForKey(t).find((t=>t.element===e))}get scope(){return this.context.scope}get schema(){return this.context.schema}get identifier(){return this.context.identifier}get application(){return this.context.application}get router(){return this.application.router}}class ${constructor(e,t){this.logDebugActivity=(e,t={})=>{const{identifier:n,controller:s,element:i}=this;t=Object.assign({identifier:n,controller:s,element:i},t),this.application.logDebugActivity(this.identifier,e,t)},this.module=e,this.scope=t,this.controller=new e.controllerConstructor(this),this.bindingObserver=new T(this,this.dispatcher),this.valueObserver=new F(this,this.controller),this.targetObserver=new x(this,this),this.outletObserver=new P(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(e){this.handleError(e,"initializing controller")}}connect(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start(),this.outletObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(e){this.handleError(e,"connecting controller")}}refresh(){this.outletObserver.refresh()}disconnect(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(e){this.handleError(e,"disconnecting controller")}this.outletObserver.stop(),this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}get application(){return this.module.application}get identifier(){return this.module.identifier}get schema(){return this.application.schema}get dispatcher(){return this.application.dispatcher}get element(){return this.scope.element}get parentElement(){return this.element.parentElement}handleError(e,t,n={}){const{identifier:s,controller:i,element:r}=this;n=Object.assign({identifier:s,controller:i,element:r},n),this.application.handleError(e,`Error ${t}`,n)}targetConnected(e,t){this.invokeControllerMethod(`${t}TargetConnected`,e)}targetDisconnected(e,t){this.invokeControllerMethod(`${t}TargetDisconnected`,e)}outletConnected(e,t,n){this.invokeControllerMethod(`${a(n)}OutletConnected`,e,t)}outletDisconnected(e,t,n){this.invokeControllerMethod(`${a(n)}OutletDisconnected`,e,t)}invokeControllerMethod(e,...t){const n=this.controller;"function"==typeof n[e]&&n[e](...t)}}function _(e){return function(e,t){const n=V(e),s=function(e,t){return D(t).reduce(((n,s)=>{const i=function(e,t,n){const s=Object.getOwnPropertyDescriptor(e,n);if(!s||!("value"in s)){const e=Object.getOwnPropertyDescriptor(t,n).value;return s&&(e.get=s.get||e.get,e.set=s.set||e.set),e}}(e,t,s);return i&&Object.assign(n,{[s]:i}),n}),{})}(e.prototype,t);return Object.defineProperties(n.prototype,s),n}(e,function(e){const t=I(e,"blessings");return t.reduce(((t,n)=>{const s=n(e);for(const e in s){const n=t[e]||{};t[e]=Object.assign(n,s[e])}return t}),{})}(e))}const D="function"==typeof Object.getOwnPropertySymbols?e=>[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)]:Object.getOwnPropertyNames,V=(()=>{function e(e){function t(){return Reflect.construct(e,arguments,new.target)}return t.prototype=Object.create(e.prototype,{constructor:{value:t}}),Reflect.setPrototypeOf(t,e),t}try{return function(){const t=e((function(){this.a.call(this)}));t.prototype.a=function(){},new t}(),e}catch(e){return e=>class extends e{}}})();class j{constructor(e,t){this.application=e,this.definition=function(e){return{identifier:e.identifier,controllerConstructor:_(e.controllerConstructor)}}(t),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}get identifier(){return this.definition.identifier}get controllerConstructor(){return this.definition.controllerConstructor}get contexts(){return Array.from(this.connectedContexts)}connectContextForScope(e){const t=this.fetchContextForScope(e);this.connectedContexts.add(t),t.connect()}disconnectContextForScope(e){const t=this.contextsByScope.get(e);t&&(this.connectedContexts.delete(t),t.disconnect())}fetchContextForScope(e){let t=this.contextsByScope.get(e);return t||(t=new $(this,e),this.contextsByScope.set(e,t)),t}}class B{constructor(e){this.scope=e}has(e){return this.data.has(this.getDataKey(e))}get(e){return this.getAll(e)[0]}getAll(e){const t=this.data.get(this.getDataKey(e))||"";return t.match(/[^\s]+/g)||[]}getAttributeName(e){return this.data.getAttributeNameForKey(this.getDataKey(e))}getDataKey(e){return`${e}-class`}get data(){return this.scope.data}}class R{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get(e){const t=this.getAttributeNameForKey(e);return this.element.getAttribute(t)}set(e,t){const n=this.getAttributeNameForKey(e);return this.element.setAttribute(n,t),this.get(e)}has(e){const t=this.getAttributeNameForKey(e);return this.element.hasAttribute(t)}delete(e){if(this.has(e)){const t=this.getAttributeNameForKey(e);return this.element.removeAttribute(t),!0}return!1}getAttributeNameForKey(e){return`data-${this.identifier}-${c(e)}`}}class q{constructor(e){this.warnedKeysByObject=new WeakMap,this.logger=e}warn(e,t,n){let s=this.warnedKeysByObject.get(e);s||(s=new Set,this.warnedKeysByObject.set(e,s)),s.has(t)||(s.add(t),this.logger.warn(n,e))}}function H(e,t){return`[${e}~="${t}"]`}class U{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return null!=this.find(e)}find(...e){return e.reduce(((e,t)=>e||this.findTarget(t)||this.findLegacyTarget(t)),void 0)}findAll(...e){return e.reduce(((e,t)=>[...e,...this.findAllTargets(t),...this.findAllLegacyTargets(t)]),[])}findTarget(e){const t=this.getSelectorForTargetName(e);return this.scope.findElement(t)}findAllTargets(e){const t=this.getSelectorForTargetName(e);return this.scope.findAllElements(t)}getSelectorForTargetName(e){return H(this.schema.targetAttributeForScope(this.identifier),e)}findLegacyTarget(e){const t=this.getLegacySelectorForTargetName(e);return this.deprecate(this.scope.findElement(t),e)}findAllLegacyTargets(e){const t=this.getLegacySelectorForTargetName(e);return this.scope.findAllElements(t).map((t=>this.deprecate(t,e)))}getLegacySelectorForTargetName(e){const t=`${this.identifier}.${e}`;return H(this.schema.targetAttribute,t)}deprecate(e,t){if(e){const{identifier:n}=this,s=this.schema.targetAttribute,i=this.schema.targetAttributeForScope(n);this.guide.warn(e,`target:${t}`,`Please replace ${s}="${n}.${t}" with ${i}="${t}". The ${s} attribute is deprecated and will be removed in a future version of Stimulus.`)}return e}get guide(){return this.scope.guide}}class K{constructor(e,t){this.scope=e,this.controllerElement=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return null!=this.find(e)}find(...e){return e.reduce(((e,t)=>e||this.findOutlet(t)),void 0)}findAll(...e){return e.reduce(((e,t)=>[...e,...this.findAllOutlets(t)]),[])}getSelectorForOutletName(e){const t=this.schema.outletAttributeForScope(this.identifier,e);return this.controllerElement.getAttribute(t)}findOutlet(e){const t=this.getSelectorForOutletName(e);if(t)return this.findElement(t,e)}findAllOutlets(e){const t=this.getSelectorForOutletName(e);return t?this.findAllElements(t,e):[]}findElement(e,t){return this.scope.queryElements(e).filter((n=>this.matchesElement(n,e,t)))[0]}findAllElements(e,t){return this.scope.queryElements(e).filter((n=>this.matchesElement(n,e,t)))}matchesElement(e,t,n){const s=e.getAttribute(this.scope.schema.controllerAttribute)||"";return e.matches(t)&&s.split(" ").includes(n)}}class z{constructor(e,t,n,s){this.targets=new U(this),this.classes=new B(this),this.data=new R(this),this.containsElement=e=>e.closest(this.controllerSelector)===this.element,this.schema=e,this.element=t,this.identifier=n,this.guide=new q(s),this.outlets=new K(this.documentScope,t)}findElement(e){return this.element.matches(e)?this.element:this.queryElements(e).find(this.containsElement)}findAllElements(e){return[...this.element.matches(e)?[this.element]:[],...this.queryElements(e).filter(this.containsElement)]}queryElements(e){return Array.from(this.element.querySelectorAll(e))}get controllerSelector(){return H(this.schema.controllerAttribute,this.identifier)}get isDocumentScope(){return this.element===document.documentElement}get documentScope(){return this.isDocumentScope?this:new z(this.schema,document.documentElement,this.identifier,this.guide.logger)}}class W{constructor(e,t,n){this.element=e,this.schema=t,this.delegate=n,this.valueListObserver=new M(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}start(){this.valueListObserver.start()}stop(){this.valueListObserver.stop()}get controllerAttribute(){return this.schema.controllerAttribute}parseValueForToken(e){const{element:t,content:n}=e;return this.parseValueForElementAndIdentifier(t,n)}parseValueForElementAndIdentifier(e,t){const n=this.fetchScopesByIdentifierForElement(e);let s=n.get(t);return s||(s=this.delegate.createScopeForElementAndIdentifier(e,t),n.set(t,s)),s}elementMatchedValue(e,t){const n=(this.scopeReferenceCounts.get(t)||0)+1;this.scopeReferenceCounts.set(t,n),1==n&&this.delegate.scopeConnected(t)}elementUnmatchedValue(e,t){const n=this.scopeReferenceCounts.get(t);n&&(this.scopeReferenceCounts.set(t,n-1),1==n&&this.delegate.scopeDisconnected(t))}fetchScopesByIdentifierForElement(e){let t=this.scopesByIdentifierByElement.get(e);return t||(t=new Map,this.scopesByIdentifierByElement.set(e,t)),t}}class J{constructor(e){this.application=e,this.scopeObserver=new W(this.element,this.schema,this),this.scopesByIdentifier=new A,this.modulesByIdentifier=new Map}get element(){return this.application.element}get schema(){return this.application.schema}get logger(){return this.application.logger}get controllerAttribute(){return this.schema.controllerAttribute}get modules(){return Array.from(this.modulesByIdentifier.values())}get contexts(){return this.modules.reduce(((e,t)=>e.concat(t.contexts)),[])}start(){this.scopeObserver.start()}stop(){this.scopeObserver.stop()}loadDefinition(e){this.unloadIdentifier(e.identifier);const t=new j(this.application,e);this.connectModule(t);const n=e.controllerConstructor.afterLoad;n&&n.call(e.controllerConstructor,e.identifier,this.application)}unloadIdentifier(e){const t=this.modulesByIdentifier.get(e);t&&this.disconnectModule(t)}getContextForElementAndIdentifier(e,t){const n=this.modulesByIdentifier.get(t);if(n)return n.contexts.find((t=>t.element==e))}proposeToConnectScopeForElementAndIdentifier(e,t){const n=this.scopeObserver.parseValueForElementAndIdentifier(e,t);n?this.scopeObserver.elementMatchedValue(n.element,n):console.error(`Couldn't find or create scope for identifier: "${t}" and element:`,e)}handleError(e,t,n){this.application.handleError(e,t,n)}createScopeForElementAndIdentifier(e,t){return new z(this.schema,e,t,this.logger)}scopeConnected(e){this.scopesByIdentifier.add(e.identifier,e);const t=this.modulesByIdentifier.get(e.identifier);t&&t.connectContextForScope(e)}scopeDisconnected(e){this.scopesByIdentifier.delete(e.identifier,e);const t=this.modulesByIdentifier.get(e.identifier);t&&t.disconnectContextForScope(e)}connectModule(e){this.modulesByIdentifier.set(e.identifier,e);this.scopesByIdentifier.getValuesForKey(e.identifier).forEach((t=>e.connectContextForScope(t)))}disconnectModule(e){this.modulesByIdentifier.delete(e.identifier);this.scopesByIdentifier.getValuesForKey(e.identifier).forEach((t=>e.disconnectContextForScope(t)))}}const G={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:e=>`data-${e}-target`,outletAttributeForScope:(e,t)=>`data-${e}-${t}-outlet`,keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End",page_up:"PageUp",page_down:"PageDown"},Q("abcdefghijklmnopqrstuvwxyz".split("").map((e=>[e,e])))),Q("0123456789".split("").map((e=>[e,e]))))};function Q(e){return e.reduce(((e,[t,n])=>Object.assign(Object.assign({},e),{[t]:n})),{})}class X{constructor(e=document.documentElement,n=G){this.logger=console,this.debug=!1,this.logDebugActivity=(e,t,n={})=>{this.debug&&this.logFormattedMessage(e,t,n)},this.element=e,this.schema=n,this.dispatcher=new t(this),this.router=new J(this),this.actionDescriptorFilters=Object.assign({},s)}static start(e,t){const n=new this(e,t);return n.start(),n}async start(){await new Promise((e=>{"loading"==document.readyState?document.addEventListener("DOMContentLoaded",(()=>e())):e()})),this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start")}stop(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}register(e,t){this.load({identifier:e,controllerConstructor:t})}registerActionOption(e,t){this.actionDescriptorFilters[e]=t}load(e,...t){(Array.isArray(e)?e:[e,...t]).forEach((e=>{e.controllerConstructor.shouldLoad&&this.router.loadDefinition(e)}))}unload(e,...t){(Array.isArray(e)?e:[e,...t]).forEach((e=>this.router.unloadIdentifier(e)))}get controllers(){return this.router.contexts.map((e=>e.controller))}getControllerForElementAndIdentifier(e,t){const n=this.router.getContextForElementAndIdentifier(e,t);return n?n.controller:null}handleError(e,t,n){var s;this.logger.error("%s\n\n%o\n\n%o",t,e,n),null===(s=window.onerror)||void 0===s||s.call(window,t,"",0,0,e)}logFormattedMessage(e,t,n={}){n=Object.assign({application:this},n),this.logger.groupCollapsed(`${e} #${t}`),this.logger.log("details:",Object.assign({},n)),this.logger.groupEnd()}}function Y(e,t,n){return e.application.getControllerForElementAndIdentifier(t,n)}function Z(e,t,n){let s=Y(e,t,n);return s||(e.application.router.proposeToConnectScopeForElementAndIdentifier(t,n),s=Y(e,t,n),s||void 0)}function ee([e,t],n){return function(e){const{token:t,typeDefinition:n}=e,s=`${c(t)}-value`,i=function(e){const{controller:t,token:n,typeDefinition:s}=e,i={controller:t,token:n,typeObject:s},r=function(e){const{controller:t,token:n,typeObject:s}=e,i=d(s.type),r=d(s.default),o=i&&r,a=i&&!r,l=!i&&r,c=te(s.type),h=ne(e.typeObject.default);if(a)return c;if(l)return h;if(c!==h){throw new Error(`The specified default value for the Stimulus Value "${t?`${t}.${n}`:n}" must match the defined type "${c}". The provided default value of "${s.default}" is of type "${h}".`)}if(o)return c}(i),o=ne(s),a=te(s),l=r||o||a;if(l)return l;const c=t?`${t}.${s}`:n;throw new Error(`Unknown value type "${c}" for "${n}" value`)}(e);return{type:i,key:s,name:o(s),get defaultValue(){return function(e){const t=te(e);if(t)return se[t];const n=h(e,"default"),s=h(e,"type"),i=e;if(n)return i.default;if(s){const{type:e}=i,t=te(e);if(t)return se[t]}return e}(n)},get hasCustomDefaultValue(){return void 0!==ne(n)},reader:ie[i],writer:re[i]||re.default}}({controller:n,token:e,typeDefinition:t})}function te(e){switch(e){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function ne(e){switch(typeof e){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}return Array.isArray(e)?"array":"[object Object]"===Object.prototype.toString.call(e)?"object":void 0}const se={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},ie={array(e){const t=JSON.parse(e);if(!Array.isArray(t))throw new TypeError(`expected value of type "array" but instead got value "${e}" of type "${ne(t)}"`);return t},boolean:e=>!("0"==e||"false"==String(e).toLowerCase()),number:e=>Number(e.replace(/_/g,"")),object(e){const t=JSON.parse(e);if(null===t||"object"!=typeof t||Array.isArray(t))throw new TypeError(`expected value of type "object" but instead got value "${e}" of type "${ne(t)}"`);return t},string:e=>e},re={default:function(e){return`${e}`},array:oe,object:oe};function oe(e){return JSON.stringify(e)}class ae{constructor(e){this.context=e}static get shouldLoad(){return!0}static afterLoad(e,t){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(e,{target:t=this.element,detail:n={},prefix:s=this.identifier,bubbles:i=!0,cancelable:r=!0}={}){const o=new CustomEvent(s?`${s}:${e}`:e,{detail:n,bubbles:i,cancelable:r});return t.dispatchEvent(o),o}}ae.blessings=[function(e){return I(e,"classes").reduce(((e,t)=>{return Object.assign(e,(n=t,{[`${n}Class`]:{get(){const{classes:e}=this;if(e.has(n))return e.get(n);{const t=e.getAttributeName(n);throw new Error(`Missing attribute "${t}"`)}}},[`${n}Classes`]:{get(){return this.classes.getAll(n)}},[`has${l(n)}Class`]:{get(){return this.classes.has(n)}}}));var n}),{})},function(e){return I(e,"targets").reduce(((e,t)=>{return Object.assign(e,(n=t,{[`${n}Target`]:{get(){const e=this.targets.find(n);if(e)return e;throw new Error(`Missing target element "${n}" for "${this.identifier}" controller`)}},[`${n}Targets`]:{get(){return this.targets.findAll(n)}},[`has${l(n)}Target`]:{get(){return this.targets.has(n)}}}));var n}),{})},function(e){const t=N(e,"values"),n={valueDescriptorMap:{get(){return t.reduce(((e,t)=>{const n=ee(t,this.identifier),s=this.data.getAttributeNameForKey(n.key);return Object.assign(e,{[s]:n})}),{})}}};return t.reduce(((e,t)=>Object.assign(e,function(e,t){const n=ee(e,t),{key:s,name:i,reader:r,writer:o}=n;return{[i]:{get(){const e=this.data.get(s);return null!==e?r(e):n.defaultValue},set(e){void 0===e?this.data.delete(s):this.data.set(s,o(e))}},[`has${l(i)}`]:{get(){return this.data.has(s)||n.hasCustomDefaultValue}}}}(t))),n)},function(e){return I(e,"outlets").reduce(((e,t)=>Object.assign(e,function(e){const t=a(e);return{[`${t}Outlet`]:{get(){const t=this.outlets.find(e),n=this.outlets.getSelectorForOutletName(e);if(t){const n=Z(this,t,e);if(n)return n;throw new Error(`The provided outlet element is missing an outlet controller "${e}" instance for host controller "${this.identifier}"`)}throw new Error(`Missing outlet element "${e}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${n}".`)}},[`${t}Outlets`]:{get(){const t=this.outlets.findAll(e);return t.length>0?t.map((t=>{const n=Z(this,t,e);if(n)return n;console.warn(`The provided outlet element is missing an outlet controller "${e}" instance for host controller "${this.identifier}"`,t)})).filter((e=>e)):[]}},[`${t}OutletElement`]:{get(){const t=this.outlets.find(e),n=this.outlets.getSelectorForOutletName(e);if(t)return t;throw new Error(`Missing outlet element "${e}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${n}".`)}},[`${t}OutletElements`]:{get(){return this.outlets.findAll(e)}},[`has${l(t)}Outlet`]:{get(){return this.outlets.has(e)}}}}(t))),{})}],ae.targets=[],ae.outlets=[],ae.values={};var le,ce,de,he,ue,pe,me,ge,fe=n(371),ve=n.n(fe);function be(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)}"function"==typeof SuppressedError&&SuppressedError;class ye extends ae{constructor(){super(...arguments),le.add(this),this.isObserving=!1,this.hasLoadedChoicesPreviously=!1,this.originalOptions=[]}initialize(){this.mutationObserver||(this.mutationObserver=new MutationObserver((e=>{this.onMutations(e)})))}connect(){this.selectElement&&(this.originalOptions=this.createOptionsDataStructure(this.selectElement)),this.initializeTomSelect()}initializeTomSelect(){this.selectElement&&this.selectElement.setAttribute("data-skip-morph",""),this.urlValue?this.tomSelect=be(this,le,"m",ue).call(this,this.urlValue,this.hasMinCharactersValue?this.minCharactersValue:null):this.optionsAsHtmlValue?this.tomSelect=be(this,le,"m",he).call(this):(this.tomSelect=be(this,le,"m",de).call(this),this.startMutationObserver())}disconnect(){this.stopMutationObserver();let e=[];this.selectElement&&(e=this.selectElement.multiple?Array.from(this.selectElement.options).filter((e=>e.selected)).map((e=>e.value)):[this.selectElement.value]),this.tomSelect.destroy(),this.selectElement&&(this.selectElement.multiple?Array.from(this.selectElement.options).forEach((t=>{t.selected=e.includes(t.value)})):this.selectElement.value=e[0])}getMaxOptions(){return this.selectElement?this.selectElement.options.length:50}get selectElement(){return this.element instanceof HTMLSelectElement?this.element:null}get formElement(){if(!(this.element instanceof HTMLInputElement||this.element instanceof HTMLSelectElement))throw new Error("Autocomplete Stimulus controller can only be used on an <input> or <select>.");return this.element}dispatchEvent(e,t){this.dispatch(e,{detail:t,prefix:"autocomplete"})}get preload(){return this.hasPreloadValue?"false"!==this.preloadValue&&("true"===this.preloadValue||this.preloadValue):"focus"}resetTomSelect(){if(this.tomSelect){this.dispatchEvent("before-reset",{tomSelect:this.tomSelect}),this.stopMutationObserver();const e=this.element.innerHTML,t=this.tomSelect.getValue();this.tomSelect.destroy(),this.element.innerHTML=e,this.initializeTomSelect(),this.tomSelect.setValue(t),this.startMutationObserver()}}changeTomSelectDisabledState(e){this.stopMutationObserver(),e?this.tomSelect.disable():this.tomSelect.enable(),this.startMutationObserver()}startMutationObserver(){!this.isObserving&&this.mutationObserver&&(this.mutationObserver.observe(this.element,{childList:!0,subtree:!0,attributes:!0,characterData:!0,attributeOldValue:!0}),this.isObserving=!0)}stopMutationObserver(){this.isObserving&&this.mutationObserver&&(this.mutationObserver.disconnect(),this.isObserving=!1)}onMutations(e){let t=!1,n=!1;e.forEach((e=>{switch(e.type){case"attributes":if(e.target===this.element&&"disabled"===e.attributeName){t=!0;break}if(e.target===this.element&&"multiple"===e.attributeName){this.element.hasAttribute("multiple")!==("multiple"===e.oldValue)&&(n=!0);break}}}));const s=this.selectElement?this.createOptionsDataStructure(this.selectElement):[];this.areOptionsEquivalent(s)&&!n||(this.originalOptions=s,this.resetTomSelect()),t&&this.changeTomSelectDisabledState(this.formElement.disabled)}createOptionsDataStructure(e){return Array.from(e.options).map((e=>({value:e.value,text:e.text})))}areOptionsEquivalent(e){const t=this.originalOptions.filter((e=>""!==e.value)),n=e.filter((e=>""!==e.value)),s=this.originalOptions.find((e=>""===e.value)),i=e.find((e=>""===e.value));if(s&&i&&s.text!==i.text)return!1;if(t.length!==n.length)return!1;const r=e=>`${e.value}-${e.text}`,o=new Set(t.map(r)),a=new Set(n.map(r));return o.size===a.size&&[...o].every((e=>a.has(e)))}}le=new WeakSet,ce=function(){const e={},t=!this.selectElement||this.selectElement.multiple;this.formElement.disabled||t||(e.clear_button={title:""}),t&&(e.remove_button={title:""}),this.urlValue&&(e.virtual_scroll={});const n={render:{no_results:()=>`<div class="no-results">${this.noResultsFoundTextValue}</div>`,option_create:(e,t)=>`<div class="create">${this.createOptionTextValue.replace("%placeholder%",`<strong>${t(e.input)}</strong>`)}</div>`},plugins:e,onItemAdd:()=>{this.tomSelect.setTextboxValue("")},closeAfterSelect:!0,onOptionAdd:(e,t)=>{let n=this.tomSelect.input,s=null;const i=t[this.tomSelect.settings.optgroupField];if(i&&this.tomSelect.optgroups&&(s=this.tomSelect.optgroups[i],s)){const e=n.querySelector(`optgroup[label="${s.label}"]`);e&&(n=e)}const r=document.createElement("option");r.value=e,r.text=t[this.tomSelect.settings.labelField];const o=t.$order;let a=null;for(const[,e]of Object.entries(this.tomSelect.options))if(e.$order===o){a=n.querySelector(`:scope > option[value="${e[this.tomSelect.settings.valueField]}"]`);break}a?a.insertAdjacentElement("afterend",r):o>=0?n.append(r):n.prepend(r)}};return this.selectElement||this.urlValue||(n.shouldLoad=()=>!1),be(this,le,"m",me).call(this,n,this.tomSelectOptionsValue)},de=function(){const e=be(this,le,"m",me).call(this,be(this,le,"m",ce).call(this),{maxOptions:this.getMaxOptions()});return be(this,le,"m",ge).call(this,e)},he=function(){const e=be(this,le,"m",ce).call(this),t=e.labelField??"text",n=be(this,le,"m",me).call(this,e,{maxOptions:this.getMaxOptions(),score:e=>{const n=this.tomSelect.getScoreFunction(e);return e=>n({...e,text:be(this,le,"m",pe).call(this,e[t])})},render:{item:e=>`<div>${e[t]}</div>`,option:e=>`<div>${e[t]}</div>`}});return be(this,le,"m",ge).call(this,n)},ue=function(e,t){const n=be(this,le,"m",ce).call(this),s=n.labelField??"text",i=be(this,le,"m",me).call(this,n,{firstUrl:t=>{const n=e.includes("?")?"&":"?";return`${e}${n}query=${encodeURIComponent(t)}`},load:function(e,t){const n=this.getUrl(e);fetch(n).then((e=>e.json())).then((n=>{this.setNextUrl(e,n.next_page),t(n.results.options||n.results,n.results.optgroups||[])})).catch((()=>t([],[])))},shouldLoad:e=>null!==t?e.length>=t:!!this.hasLoadedChoicesPreviously||(e.length>0&&(this.hasLoadedChoicesPreviously=!0),e.length>=3),optgroupField:"group_by",score:e=>e=>1,render:{option:e=>`<div>${e[s]}</div>`,item:e=>`<div>${e[s]}</div>`,loading_more:()=>`<div class="loading-more-results">${this.loadingMoreTextValue}</div>`,no_more_results:()=>`<div class="no-more-results">${this.noMoreResultsTextValue}</div>`,no_results:()=>`<div class="no-results">${this.noResultsFoundTextValue}</div>`,option_create:(e,t)=>`<div class="create">${this.createOptionTextValue.replace("%placeholder%",`<strong>${t(e.input)}</strong>`)}</div>`},preload:this.preload});return be(this,le,"m",ge).call(this,i)},pe=function(e){return e.replace(/(<([^>]+)>)/gi,"")},me=function(e,t){return{...e,...t}},ge=function(e){const t={options:e};this.dispatchEvent("pre-connect",t);const n=new(ve())(this.formElement,e),s={tomSelect:n,options:e};return this.dispatchEvent("connect",s),n},ye.values={url:String,optionsAsHtml:Boolean,loadingMoreText:String,noResultsFoundText:String,noMoreResultsText:String,createOptionText:String,minCharacters:Number,tomSelectOptions:Object,preload:String};class Ee{constructor(e,t,n){this.isResolved=!1,this.promise=e,this.promise.then((e=>(this.isResolved=!0,e))),this.actions=t,this.updatedModels=n}containsOneOfActions(e){return this.actions.filter((t=>e.includes(t))).length>0}areAnyModelsUpdated(e){return this.updatedModels.filter((t=>e.includes(t))).length>0}}class Oe{constructor(e,t="post"){this.url=e,this.method=t}buildRequest(e,t,n,s,i,r){const o=this.url.split("?");let[a]=o;const[,l]=o,c=new URLSearchParams(l||""),d={headers:{Accept:"application/vnd.live-component+html","X-Requested-With":"XMLHttpRequest"}},h=Object.entries(r).reduce(((e,t)=>e+t.length),0),u=Object.keys(s).length>0;if(0===t.length&&0===h&&"get"===this.method&&this.willDataFitInUrl(JSON.stringify(e),JSON.stringify(n),c,JSON.stringify(s),JSON.stringify(i)))c.set("props",JSON.stringify(e)),c.set("updated",JSON.stringify(n)),Object.keys(i).length>0&&c.set("propsFromParent",JSON.stringify(i)),u&&c.set("children",JSON.stringify(s)),d.method="GET";else{d.method="POST";const o={props:e,updated:n};Object.keys(i).length>0&&(o.propsFromParent=i),u&&(o.children=s),t.length>0&&(1===t.length?(o.args=t[0].args,a+=`/${encodeURIComponent(t[0].name)}`):(a+="/_batch",o.actions=t));const l=new FormData;l.append("data",JSON.stringify(o));for(const[e,t]of Object.entries(r)){const n=t.length;for(let s=0;s<n;++s)l.append(e,t[s])}d.body=l}const p=c.toString();return{url:`${a}${p.length>0?`?${p}`:""}`,fetchOptions:d}}willDataFitInUrl(e,t,n,s,i){return(new URLSearchParams(e+t+s+i).toString()+n.toString()).length<1500}}class we{constructor(e,t="post"){this.requestBuilder=new Oe(e,t)}makeRequest(e,t,n,s,i,r){const{url:o,fetchOptions:a}=this.requestBuilder.buildRequest(e,t,n,s,i,r);return new Ee(fetch(o,a),t.map((e=>e.name)),Object.keys(n))}}class Ae{constructor(e){this.response=e}async getBody(){return this.body||(this.body=await this.response.text()),this.body}}function ke(e){return e.innerHTML?e.outerHTML.slice(0,e.outerHTML.indexOf(e.innerHTML)):e.outerHTML}let Se=new WeakMap,Ce=new Map;class Me{constructor(){this.hooks=new Map}register(e,t){const n=this.hooks.get(e)||[];n.push(t),this.hooks.set(e,n)}unregister(e,t){const n=this.hooks.get(e)||[],s=n.indexOf(t);-1!==s&&(n.splice(s,1),this.hooks.set(e,n))}triggerHook(e,...t){(this.hooks.get(e)||[]).forEach((e=>e(...t)))}}class Te{constructor(){this.changedItems=new Map,this.removedItems=new Map}setItem(e,t,n){if(this.removedItems.has(e)){const n=this.removedItems.get(e);if(this.removedItems.delete(e),n.original===t)return}if(this.changedItems.has(e)){const n=this.changedItems.get(e);return n.original===t?void this.changedItems.delete(e):void this.changedItems.set(e,{original:n.original,new:t})}this.changedItems.set(e,{original:n,new:t})}removeItem(e,t){let n=t;if(this.changedItems.has(e)){if(n=this.changedItems.get(e).original,this.changedItems.delete(e),null===n)return}this.removedItems.has(e)||this.removedItems.set(e,{original:n})}getChangedItems(){return Array.from(this.changedItems,(([e,{new:t}])=>({name:e,value:t})))}getRemovedItems(){return Array.from(this.removedItems.keys())}isEmpty(){return 0===this.changedItems.size&&0===this.removedItems.size}}class Fe{constructor(){this.addedClasses=new Set,this.removedClasses=new Set,this.styleChanges=new Te,this.attributeChanges=new Te}addClass(e){this.removedClasses.delete(e)||this.addedClasses.add(e)}removeClass(e){this.addedClasses.delete(e)||this.removedClasses.add(e)}addStyle(e,t,n){this.styleChanges.setItem(e,t,n)}removeStyle(e,t){this.styleChanges.removeItem(e,t)}addAttribute(e,t,n){this.attributeChanges.setItem(e,t,n)}removeAttribute(e,t){this.attributeChanges.removeItem(e,t)}getAddedClasses(){return[...this.addedClasses]}getRemovedClasses(){return[...this.removedClasses]}getChangedStyles(){return this.styleChanges.getChangedItems()}getRemovedStyles(){return this.styleChanges.getRemovedItems()}getChangedAttributes(){return this.attributeChanges.getChangedItems()}getRemovedAttributes(){return this.attributeChanges.getRemovedItems()}applyToElement(e){e.classList.add(...this.addedClasses),e.classList.remove(...this.removedClasses),this.styleChanges.getChangedItems().forEach((t=>{e.style.setProperty(t.name,t.value)})),this.styleChanges.getRemovedItems().forEach((t=>{e.style.removeProperty(t)})),this.attributeChanges.getChangedItems().forEach((t=>{e.setAttribute(t.name,t.value)})),this.attributeChanges.getRemovedItems().forEach((t=>{e.removeAttribute(t)}))}isEmpty(){return 0===this.addedClasses.size&&0===this.removedClasses.size&&this.styleChanges.isEmpty()&&this.attributeChanges.isEmpty()}}class xe{constructor(e,t){this.changedElements=new WeakMap,this.changedElementsCount=0,this.addedElements=[],this.removedElements=[],this.isStarted=!1,this.element=e,this.shouldTrackChangeCallback=t,this.mutationObserver=new MutationObserver(this.onMutations.bind(this))}start(){this.isStarted||(this.mutationObserver.observe(this.element,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0}),this.isStarted=!0)}stop(){this.isStarted&&(this.mutationObserver.disconnect(),this.isStarted=!1)}getChangedElement(e){return this.changedElements.has(e)?this.changedElements.get(e):null}getAddedElements(){return this.addedElements}wasElementAdded(e){return this.addedElements.includes(e)}handlePendingChanges(){this.onMutations(this.mutationObserver.takeRecords())}onMutations(e){const t=new WeakMap;for(const n of e){const e=n.target;if(!this.shouldTrackChangeCallback(e))continue;if(this.isElementAddedByTranslation(e))continue;let s=!1;for(const t of this.addedElements)if(t.contains(e)){s=!0;break}if(!s)switch(n.type){case"childList":this.handleChildListMutation(n);break;case"attributes":t.has(e)||t.set(e,[]),t.get(e).includes(n.attributeName)||(this.handleAttributeMutation(n),t.set(e,[...t.get(e),n.attributeName]))}}}handleChildListMutation(e){e.addedNodes.forEach((e=>{e instanceof Element&&(this.removedElements.includes(e)?this.removedElements.splice(this.removedElements.indexOf(e),1):this.isElementAddedByTranslation(e)||this.addedElements.push(e))})),e.removedNodes.forEach((e=>{e instanceof Element&&(this.addedElements.includes(e)?this.addedElements.splice(this.addedElements.indexOf(e),1):this.removedElements.push(e))}))}handleAttributeMutation(e){const t=e.target;this.changedElements.has(t)||(this.changedElements.set(t,new Fe),this.changedElementsCount++);const n=this.changedElements.get(t);switch(e.attributeName){case"class":this.handleClassAttributeMutation(e,n);break;case"style":this.handleStyleAttributeMutation(e,n);break;default:this.handleGenericAttributeMutation(e,n)}n.isEmpty()&&(this.changedElements.delete(t),this.changedElementsCount--)}handleClassAttributeMutation(e,t){const n=e.target,s=(e.oldValue||"").match(/(\S+)/gu)||[],i=[].slice.call(n.classList),r=i.filter((e=>!s.includes(e))),o=s.filter((e=>!i.includes(e)));r.forEach((e=>{t.addClass(e)})),o.forEach((e=>{t.removeClass(e)}))}handleStyleAttributeMutation(e,t){const n=e.target,s=e.oldValue||"",i=this.extractStyles(s),r=n.getAttribute("style")||"",o=this.extractStyles(r),a=Object.keys(o).filter((e=>void 0===i[e]||i[e]!==o[e])),l=Object.keys(i).filter((e=>!o[e]));a.forEach((e=>{t.addStyle(e,o[e],void 0===i[e]?null:i[e])})),l.forEach((e=>{t.removeStyle(e,i[e])}))}handleGenericAttributeMutation(e,t){const n=e.attributeName,s=e.target;let i=e.oldValue,r=s.getAttribute(n);if(i===n&&(i=""),r===n&&(r=""),s.hasAttribute(n))r!==i&&t.addAttribute(n,s.getAttribute(n),e.oldValue);else{if(null===i)return;t.removeAttribute(n,e.oldValue)}}extractStyles(e){const t={};return e.split(";").forEach((e=>{const n=e.split(":");if(1===n.length)return;const s=n[0].trim();t[s]=n.slice(1).join(":").trim()})),t}isElementAddedByTranslation(e){return"FONT"===e.tagName&&"vertical-align: inherit;"===e.getAttribute("style")}}function Ie(e){const t=[];if(!e)return t;let n="",s="",i=[],r=[],o="action";const a=()=>{if(n)return n;if(0===t.length)throw new Error("Could not find any directives");return t[t.length-1].action},l=()=>{t.push({action:n,args:i,modifiers:r,getString:()=>e}),n="",s="",i=[],r=[],o="action"},c=()=>{i.push(s.trim()),s=""},d=()=>{if(i.length>1)throw new Error(`The modifier "${n}()" does not support multiple arguments.`);r.push({name:n,value:i.length>0?i[0]:null}),n="",i=[],o="action"};for(let t=0;t<e.length;t++){const i=e[t];switch(o){case"action":if("("===i){o="arguments";break}if(" "===i){n&&l();break}if("|"===i){d();break}n+=i;break;case"arguments":if(")"===i){c(),o="after_arguments";break}if(","===i){c();break}s+=i;break;case"after_arguments":if("|"===i){d();break}if(" "!==i)throw new Error(`Missing space after ${a()}()`);l()}}switch(o){case"action":case"after_arguments":n&&l();break;default:throw new Error(`Did you forget to add a closing ")" after "${n}"?`)}return t}function Ne(e){const t=[];return e.forEach((e=>{var n;t.push(...(n=e,n.replace(/[\s]+/g," ").trim()).split(" "))})),t}function Le(e){return e.replace(/\[]$/,"").split("[").map((e=>e.replace("]",""))).join(".")}function Pe(e,t){if(e instanceof HTMLInputElement){if("checkbox"===e.type){const n=De(e,!1);if(null!==n){const s=t.get(n.action);if(Array.isArray(s))return Be(e,s);if(Object(s)===s)return Be(e,Object.values(s))}return e.hasAttribute("value")?e.checked?e.getAttribute("value"):null:e.checked}return Re(e)}return e instanceof HTMLSelectElement?e.multiple?Array.from(e.selectedOptions).map((e=>e.value)):e.value:e.dataset.value?e.dataset.value:"value"in e?e.value:e.hasAttribute("value")?e.getAttribute("value"):null}function $e(e,t){if(e instanceof HTMLInputElement){if("file"===e.type)return;if("radio"===e.type)return void(e.checked=e.value==t);if("checkbox"===e.type)return void(Array.isArray(t)?e.checked=t.some((t=>t==e.value)):e.hasAttribute("value")?e.checked=e.value==t:e.checked=t)}if(e instanceof HTMLSelectElement){const n=[].concat(t).map((e=>`${e}`));Array.from(e.options).forEach((e=>{e.selected=n.includes(e.value)}))}else t=void 0===t?"":t,e.value=t}function _e(e){if(!e.dataset.model)return[];const t=Ie(e.dataset.model);return t.forEach((t=>{if(t.args.length>0)throw new Error(`The data-model="${e.dataset.model}" format is invalid: it does not support passing arguments to the model.`);t.action=Le(t.action)})),t}function De(e,t=!0){const n=_e(e);if(n.length>0)return n[0];if(e.getAttribute("name")){const t=e.closest("form");if(t&&"model"in t.dataset){const n=Ie(t.dataset.model||"*")[0];if(n.args.length>0)throw new Error(`The data-model="${t.dataset.model}" format is invalid: it does not support passing arguments to the model.`);return n.action=Le(e.getAttribute("name")),n}}if(!t)return null;throw new Error(`Cannot determine the model name for "${ke(e)}": the element must either have a "data-model" (or "name" attribute living inside a <form data-model="*">).`)}function Ve(e,t){if(t.element===e)return!0;if(!t.element.contains(e))return!1;return e.closest('[data-controller~="live"]')===t.element}function je(e){const t=e.cloneNode(!0);if(!(t instanceof HTMLElement))throw new Error("Could not clone element");return t}const Be=(e,t)=>{const n=[...t],s=Re(e),i=t.indexOf(s);return e.checked?(-1===i&&n.push(s),n):(i>-1&&n.splice(i,1),n)},Re=e=>e.dataset.value?e.dataset.value:e.value;var qe=function(){let e=new Set,t={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:c,afterNodeAdded:c,beforeNodeMorphed:c,afterNodeMorphed:c,beforeNodeRemoved:c,afterNodeRemoved:c,beforeAttributeUpdated:c},head:{style:"merge",shouldPreserve:function(e){return"true"===e.getAttribute("im-preserve")},shouldReAppend:function(e){return"true"===e.getAttribute("im-re-append")},shouldRemove:c,afterHeadMorphed:c}};function n(e,t,s){if(s.head.block){let i=e.querySelector("head"),r=t.querySelector("head");if(i&&r){let o=l(r,i,s);return void Promise.all(o).then((function(){n(e,t,Object.assign(s,{head:{block:!1,ignore:!0}}))}))}}if("innerHTML"===s.morphStyle)return r(t,e,s),e.children;if("outerHTML"===s.morphStyle||null==s.morphStyle){let n=function(e,t,n){let s;s=e.firstChild;let i=s,r=0;for(;s;){let e=g(s,t,n);e>r&&(i=s,r=e),s=s.nextSibling}return i}(t,e,s),r=n?.previousSibling,o=n?.nextSibling,a=i(e,n,s);return n?function(e,t,n){let s=[],i=[];for(;null!=e;)s.push(e),e=e.previousSibling;for(;s.length>0;){let e=s.pop();i.push(e),t.parentElement.insertBefore(e,t)}i.push(t);for(;null!=n;)s.push(n),i.push(n),n=n.nextSibling;for(;s.length>0;)t.parentElement.insertBefore(s.pop(),t.nextSibling);return i}(r,a,o):[]}throw"Do not understand how to morph style "+s.morphStyle}function s(e,t){return t.ignoreActiveValue&&e===document.activeElement}function i(e,t,n){if(!n.ignoreActive||e!==document.activeElement)return null==t?!1===n.callbacks.beforeNodeRemoved(e)?e:(e.remove(),n.callbacks.afterNodeRemoved(e),null):h(e,t)?(!1===n.callbacks.beforeNodeMorphed(e,t)||(e instanceof HTMLHeadElement&&n.head.ignore||(e instanceof HTMLHeadElement&&"morph"!==n.head.style?l(t,e,n):(!function(e,t,n){let i=e.nodeType;if(1===i){const s=e.attributes,i=t.attributes;for(const e of s)o(e.name,t,"update",n)||t.getAttribute(e.name)!==e.value&&t.setAttribute(e.name,e.value);for(let s=i.length-1;0<=s;s--){const r=i[s];o(r.name,t,"remove",n)||(e.hasAttribute(r.name)||t.removeAttribute(r.name))}}8!==i&&3!==i||t.nodeValue!==e.nodeValue&&(t.nodeValue=e.nodeValue);s(t,n)||function(e,t,n){if(e instanceof HTMLInputElement&&t instanceof HTMLInputElement&&"file"!==e.type){let s=e.value,i=t.value;a(e,t,"checked",n),a(e,t,"disabled",n),e.hasAttribute("value")?s!==i&&(o("value",t,"update",n)||(t.setAttribute("value",s),t.value=s)):o("value",t,"remove",n)||(t.value="",t.removeAttribute("value"))}else if(e instanceof HTMLOptionElement)a(e,t,"selected",n);else if(e instanceof HTMLTextAreaElement&&t instanceof HTMLTextAreaElement){let s=e.value,i=t.value;if(o("value",t,"update",n))return;s!==i&&(t.value=s),t.firstChild&&t.firstChild.nodeValue!==s&&(t.firstChild.nodeValue=s)}}(e,t,n)}(t,e,n),s(e,n)||r(t,e,n))),n.callbacks.afterNodeMorphed(e,t)),e):!1===n.callbacks.beforeNodeRemoved(e)||!1===n.callbacks.beforeNodeAdded(t)?e:(e.parentElement.replaceChild(t,e),n.callbacks.afterNodeAdded(t),n.callbacks.afterNodeRemoved(e),t)}function r(e,t,n){let s,r=e.firstChild,o=t.firstChild;for(;r;){if(s=r,r=s.nextSibling,null==o){if(!1===n.callbacks.beforeNodeAdded(s))return;t.appendChild(s),n.callbacks.afterNodeAdded(s),y(n,s);continue}if(d(s,o,n)){i(o,s,n),o=o.nextSibling,y(n,s);continue}let a=p(e,t,s,o,n);if(a){o=u(o,a,n),i(a,s,n),y(n,s);continue}let l=m(e,t,s,o,n);if(l)o=u(o,l,n),i(l,s,n),y(n,s);else{if(!1===n.callbacks.beforeNodeAdded(s))return;t.insertBefore(s,o),n.callbacks.afterNodeAdded(s),y(n,s)}}for(;null!==o;){let e=o;o=o.nextSibling,f(e,n)}}function o(e,t,n,s){return!("value"!==e||!s.ignoreActiveValue||t!==document.activeElement)||!1===s.callbacks.beforeAttributeUpdated(e,t,n)}function a(e,t,n,s){if(e[n]!==t[n]){let i=o(n,t,"update",s);i||(t[n]=e[n]),e[n]?i||t.setAttribute(n,e[n]):o(n,t,"remove",s)||t.removeAttribute(n)}}function l(e,t,n){let s=[],i=[],r=[],o=[],a=n.head.style,l=new Map;for(const t of e.children)l.set(t.outerHTML,t);for(const e of t.children){let t=l.has(e.outerHTML),s=n.head.shouldReAppend(e),c=n.head.shouldPreserve(e);t||c?s?i.push(e):(l.delete(e.outerHTML),r.push(e)):"append"===a?s&&(i.push(e),o.push(e)):!1!==n.head.shouldRemove(e)&&i.push(e)}o.push(...l.values());let c=[];for(const e of o){let i=document.createRange().createContextualFragment(e.outerHTML).firstChild;if(!1!==n.callbacks.beforeNodeAdded(i)){if(i.href||i.src){let e=null,t=new Promise((function(t){e=t}));i.addEventListener("load",(function(){e()})),c.push(t)}t.appendChild(i),n.callbacks.afterNodeAdded(i),s.push(i)}}for(const e of i)!1!==n.callbacks.beforeNodeRemoved(e)&&(t.removeChild(e),n.callbacks.afterNodeRemoved(e));return n.head.afterHeadMorphed(t,{added:s,kept:r,removed:i}),c}function c(){}function d(e,t,n){return null!=e&&null!=t&&(e.nodeType===t.nodeType&&e.tagName===t.tagName&&(""!==e.id&&e.id===t.id||E(n,e,t)>0))}function h(e,t){return null!=e&&null!=t&&(e.nodeType===t.nodeType&&e.tagName===t.tagName)}function u(e,t,n){for(;e!==t;){let t=e;e=e.nextSibling,f(t,n)}return y(n,t),t.nextSibling}function p(e,t,n,s,i){let r=E(i,n,t);if(r>0){let t=s,o=0;for(;null!=t;){if(d(n,t,i))return t;if(o+=E(i,t,e),o>r)return null;t=t.nextSibling}}return null}function m(e,t,n,s,i){let r=s,o=n.nextSibling,a=0;for(;null!=r;){if(E(i,r,e)>0)return null;if(h(n,r))return r;if(h(o,r)&&(a++,o=o.nextSibling,a>=2))return null;r=r.nextSibling}return r}function g(e,t,n){return h(e,t)?.5+E(n,e,t):0}function f(e,t){y(t,e),!1!==t.callbacks.beforeNodeRemoved(e)&&(e.remove(),t.callbacks.afterNodeRemoved(e))}function v(e,t){return!e.deadIds.has(t)}function b(t,n,s){return(t.idMap.get(s)||e).has(n)}function y(t,n){let s=t.idMap.get(n)||e;for(const e of s)t.deadIds.add(e)}function E(t,n,s){let i=t.idMap.get(n)||e,r=0;for(const e of i)v(t,e)&&b(t,e,s)&&++r;return r}function O(e,t){let n=e.parentElement,s=e.querySelectorAll("[id]");for(const e of s){let s=e;for(;s!==n&&null!=s;){let n=t.get(s);null==n&&(n=new Set,t.set(s,n)),n.add(e.id),s=s.parentElement}}}function w(e,t){let n=new Map;return O(e,n),O(t,n),n}return{morph:function(e,s,i={}){e instanceof Document&&(e=e.documentElement),"string"==typeof s&&(s=function(e){let t=new DOMParser,n=e.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(n.match(/<\/html>/)||n.match(/<\/head>/)||n.match(/<\/body>/)){let s=t.parseFromString(e,"text/html");if(n.match(/<\/html>/))return s.generatedByIdiomorph=!0,s;{let e=s.firstChild;return e?(e.generatedByIdiomorph=!0,e):null}}{let n=t.parseFromString("<body><template>"+e+"</template></body>","text/html").body.querySelector("template").content;return n.generatedByIdiomorph=!0,n}}(s));let r=function(e){if(null==e){return document.createElement("div")}if(e.generatedByIdiomorph)return e;if(e instanceof Node){const t=document.createElement("div");return t.append(e),t}{const t=document.createElement("div");for(const n of[...e])t.append(n);return t}}(s),o=function(e,n,s){return s=function(e){let n={};return Object.assign(n,t),Object.assign(n,e),n.callbacks={},Object.assign(n.callbacks,t.callbacks),Object.assign(n.callbacks,e.callbacks),n.head={},Object.assign(n.head,t.head),Object.assign(n.head,e.head),n}(s),{target:e,newContent:n,config:s,morphStyle:s.morphStyle,ignoreActive:s.ignoreActive,ignoreActiveValue:s.ignoreActiveValue,idMap:w(e,n),deadIds:new Set,callbacks:s.callbacks,head:s.head}}(e,r,i);return n(e,r,o)},defaults:t}}();function He(e){e instanceof HTMLInputElement&&"file"===e.type||("value"in e?e.setAttribute("value",e.value):e.hasAttribute("value")&&e.setAttribute("value","")),Array.from(e.children).forEach((e=>{He(e)}))}class Ue{constructor(e,t){this.elementEventListeners=[{event:"input",callback:e=>this.handleInputEvent(e)}],this.component=e,this.modelElementResolver=t,this.unsyncedInputs=new Ke}activate(){this.elementEventListeners.forEach((({event:e,callback:t})=>{this.component.element.addEventListener(e,t)}))}deactivate(){this.elementEventListeners.forEach((({event:e,callback:t})=>{this.component.element.removeEventListener(e,t)}))}markModelAsSynced(e){this.unsyncedInputs.markModelAsSynced(e)}handleInputEvent(e){const t=e.target;t&&this.updateModelFromElement(t)}updateModelFromElement(e){if(!Ve(e,this.component))return;if(!(e instanceof HTMLElement))throw new Error("Could not update model for non HTMLElement");const t=this.modelElementResolver.getModelName(e);this.unsyncedInputs.add(e,t)}getUnsyncedInputs(){return this.unsyncedInputs.allUnsyncedInputs()}getUnsyncedModels(){return Array.from(this.unsyncedInputs.getUnsyncedModelNames())}resetUnsyncedFields(){this.unsyncedInputs.resetUnsyncedFields()}}class Ke{constructor(){this.unsyncedNonModelFields=[],this.unsyncedModelNames=[],this.unsyncedModelFields=new Map}add(e,t=null){if(t)return this.unsyncedModelFields.set(t,e),void(this.unsyncedModelNames.includes(t)||this.unsyncedModelNames.push(t));this.unsyncedNonModelFields.push(e)}resetUnsyncedFields(){this.unsyncedModelFields.forEach(((e,t)=>{this.unsyncedModelNames.includes(t)||this.unsyncedModelFields.delete(t)}))}allUnsyncedInputs(){return[...this.unsyncedNonModelFields,...this.unsyncedModelFields.values()]}markModelAsSynced(e){const t=this.unsyncedModelNames.indexOf(e);-1!==t&&this.unsyncedModelNames.splice(t,1)}getUnsyncedModelNames(){return this.unsyncedModelNames}}const ze=(e,t)=>{const n=JSON.parse(JSON.stringify(e));let s=n;const i=t.split(".");for(let e=0;e<i.length-1;e++)s=s[i[e]];return{currentLevelData:s,finalData:n,finalKey:i[i.length-1],parts:i}};class We{constructor(e){this.props={},this.dirtyProps={},this.pendingProps={},this.updatedPropsFromParent={},this.props=e}get(e){const t=Le(e);return void 0!==this.dirtyProps[t]?this.dirtyProps[t]:void 0!==this.pendingProps[t]?this.pendingProps[t]:void 0!==this.props[t]?this.props[t]:function(e,t){const{currentLevelData:n,finalKey:s}=ze(e,t);if(void 0!==n)return n[s]}(this.props,t)}has(e){return void 0!==this.get(e)}set(e,t){const n=Le(e);return this.get(n)!==t&&(this.dirtyProps[n]=t,!0)}getOriginalProps(){return{...this.props}}getDirtyProps(){return{...this.dirtyProps}}getUpdatedPropsFromParent(){return{...this.updatedPropsFromParent}}flushDirtyPropsToPending(){this.pendingProps={...this.dirtyProps},this.dirtyProps={}}reinitializeAllProps(e){this.props=e,this.updatedPropsFromParent={},this.pendingProps={}}pushPendingPropsBackToDirty(){this.dirtyProps={...this.pendingProps,...this.dirtyProps},this.pendingProps={}}storeNewPropsFromParent(e){let t=!1;for(const[n,s]of Object.entries(e)){this.get(n)!==s&&(t=!0)}return t&&(this.updatedPropsFromParent=e),t}}class Je{constructor(e,t,n,s,i,r,o){this.fingerprint="",this.defaultDebounce=150,this.backendRequest=null,this.pendingActions=[],this.pendingFiles={},this.isRequestPending=!1,this.requestDebounceTimeout=null,this.element=e,this.name=t,this.backend=r,this.elementDriver=o,this.id=i,this.listeners=new Map,s.forEach((e=>{this.listeners.has(e.event)||this.listeners.set(e.event,[]),this.listeners.get(e.event)?.push(e.action)})),this.valueStore=new We(n),this.unsyncedInputsTracker=new Ue(this,o),this.hooks=new Me,this.resetPromise(),this.externalMutationTracker=new xe(this.element,(e=>Ve(e,this))),this.externalMutationTracker.start()}addPlugin(e){e.attachToComponent(this)}connect(){var e;e=this,Se.set(e.element,e),Ce.set(e,e.name),this.hooks.triggerHook("connect",this),this.unsyncedInputsTracker.activate(),this.externalMutationTracker.start()}disconnect(){var e;e=this,Se.delete(e.element),Ce.delete(e),this.hooks.triggerHook("disconnect",this),this.clearRequestDebounceTimeout(),this.unsyncedInputsTracker.deactivate(),this.externalMutationTracker.stop()}on(e,t){this.hooks.register(e,t)}off(e,t){this.hooks.unregister(e,t)}set(e,t,n=!1,s=!1){const i=this.nextRequestPromise,r=Le(e);if(!this.valueStore.has(r))throw new Error(`Invalid model name "${e}".`);const o=this.valueStore.set(r,t);return this.hooks.triggerHook("model:set",e,t,this),this.unsyncedInputsTracker.markModelAsSynced(r),n&&o&&this.debouncedStartRequest(s),i}getData(e){const t=Le(e);if(!this.valueStore.has(t))throw new Error(`Invalid model "${e}".`);return this.valueStore.get(t)}action(e,t={},n=!1){const s=this.nextRequestPromise;return this.pendingActions.push({name:e,args:t}),this.debouncedStartRequest(n),s}files(e,t){this.pendingFiles[e]=t}render(){const e=this.nextRequestPromise;return this.tryStartingRequest(),e}getUnsyncedModels(){return this.unsyncedInputsTracker.getUnsyncedModels()}emit(e,t,n=null){this.performEmit(e,t,!1,n)}emitUp(e,t,n=null){this.performEmit(e,t,!0,n)}emitSelf(e,t){this.doEmit(e,t)}performEmit(e,t,n,s){((e,t,n)=>{const s=[];return Ce.forEach(((i,r)=>{(!t||e!==r&&r.element.contains(e.element))&&(n&&i!==n||s.push(r))})),s})(this,n,s).forEach((n=>{n.doEmit(e,t)}))}doEmit(e,t){if(!this.listeners.has(e))return;(this.listeners.get(e)||[]).forEach((e=>{this.action(e,t,1)}))}isTurboEnabled(){return"undefined"!=typeof Turbo&&!this.element.closest('[data-turbo="false"]')}tryStartingRequest(){this.backendRequest?this.isRequestPending=!0:this.performRequest()}performRequest(){const e=this.nextRequestPromiseResolve;this.resetPromise(),this.unsyncedInputsTracker.resetUnsyncedFields();const t={};for(const[e,n]of Object.entries(this.pendingFiles))n.files&&(t[e]=n.files);const n={props:this.valueStore.getOriginalProps(),actions:this.pendingActions,updated:this.valueStore.getDirtyProps(),children:{},updatedPropsFromParent:this.valueStore.getUpdatedPropsFromParent(),files:t};this.hooks.triggerHook("request:started",n),this.backendRequest=this.backend.makeRequest(n.props,n.actions,n.updated,n.children,n.updatedPropsFromParent,n.files),this.hooks.triggerHook("loading.state:started",this.element,this.backendRequest),this.pendingActions=[],this.valueStore.flushDirtyPropsToPending(),this.isRequestPending=!1,this.backendRequest.promise.then((async t=>{const n=new Ae(t),s=await n.getBody();for(const e of Object.values(this.pendingFiles))e.value="";const i=n.response.headers;if(!i.get("Content-Type")?.includes("application/vnd.live-component+html")&&!i.get("X-Live-Redirect")){const i={displayError:!0};return this.valueStore.pushPendingPropsBackToDirty(),this.hooks.triggerHook("response:error",n,i),i.displayError&&this.renderError(s),this.backendRequest=null,e(n),t}return this.processRerender(s,n),this.backendRequest=null,e(n),this.isRequestPending&&(this.isRequestPending=!1,this.performRequest()),t}))}processRerender(e,t){const n={shouldRender:!0};if(this.hooks.triggerHook("render:started",e,t,n),!n.shouldRender)return;if(t.response.headers.get("Location"))return void(this.isTurboEnabled()?Turbo.visit(t.response.headers.get("Location")):window.location.href=t.response.headers.get("Location")||"");this.hooks.triggerHook("loading.state:finished",this.element);const s={};let i;Object.keys(this.valueStore.getDirtyProps()).forEach((e=>{s[e]=this.valueStore.get(e)}));try{if(i=function(e){const t=document.createElement("template");if(e=e.trim(),t.innerHTML=e,t.content.childElementCount>1)throw new Error(`Component HTML contains ${t.content.childElementCount} elements, but only 1 root element is allowed.`);const n=t.content.firstElementChild;if(!n)throw new Error("Child not found");if(!(n instanceof HTMLElement))throw new Error(`Created element is not an HTMLElement: ${e.trim()}`);return n}(e),!i.matches("[data-controller~=live]"))throw new Error("A live component template must contain a single root controller element.")}catch(e){throw console.error(`There was a problem with the '${this.name}' component HTML returned:`,{id:this.id}),e}this.externalMutationTracker.handlePendingChanges(),this.externalMutationTracker.stop(),function(e,t,n,s,i){const r=[],o=new Map,a=(e,t)=>{const n=o.get(e);if(!(n instanceof HTMLElement))throw new Error(`Original element with id ${e} not found`);if(r.push(e),!t)return null;const s=je(n);return n.replaceWith(s),s};t.querySelectorAll("[data-live-preserve]").forEach((t=>{const n=t.id;if(!n)throw new Error("The data-live-preserve attribute requires an id attribute to be set on the element");const s=e.querySelector(`#${n}`);if(!(s instanceof HTMLElement))throw new Error(`The element with id "${n}" was not found in the original HTML`);t.removeAttribute("data-live-preserve"),o.set(n,s),((e,t)=>{for(let n=0;n<e.attributes.length;n++){const s=e.attributes[n];t.setAttribute(s.name,s.value)}})(t,s)})),qe.morph(e,t,{callbacks:{beforeNodeMorphed:(t,r)=>{if(!(t instanceof Element&&r instanceof Element))return!0;if(t===e)return!0;if(t.id&&o.has(t.id)){if(t.id===r.id)return!1;const e=a(t.id,!0);if(!e)throw new Error("missing clone");return qe.morph(e,r),!1}if(t instanceof HTMLElement&&r instanceof HTMLElement){if(void 0!==t.__x){if(!window.Alpine)throw new Error("Unable to access Alpine.js though the global window.Alpine variable. Please make sure Alpine.js is loaded before Symfony UX LiveComponent.");if("function"!=typeof window.Alpine.morph)throw new Error("Unable to access Alpine.js morph function. Please make sure the Alpine.js Morph plugin is installed and loaded, see https://alpinejs.dev/plugins/morph for more information.");window.Alpine.morph(t.__x,r)}if(i.wasElementAdded(t))return t.insertAdjacentElement("afterend",r),!1;n.includes(t)&&$e(r,s(t)),t===document.activeElement&&t!==document.body&&null!==De(t,!1)&&$e(r,s(t));const e=i.getChangedElement(t);if(e&&e.applyToElement(r),"OPTION"!==t.nodeName.toUpperCase()&&t.isEqualNode(r)){const e=je(t);He(e);const n=je(r);if(He(n),e.isEqualNode(n))return!1}}return t.hasAttribute("data-skip-morph")||t.id&&t.id!==r.id?(t.innerHTML=r.innerHTML,!0):!t.parentElement?.hasAttribute("data-skip-morph")&&!t.hasAttribute("data-live-ignore")},beforeNodeRemoved:e=>!(e instanceof HTMLElement&&(e.id&&o.has(e.id)?(a(e.id,!1),0):i.wasElementAdded(e)||e.hasAttribute("data-live-ignore")))}}),r.forEach((t=>{const n=e.querySelector(`#${t}`),s=o.get(t);if(!(n instanceof HTMLElement&&s instanceof HTMLElement))throw new Error("Missing elements.");n.replaceWith(s)}))}(this.element,i,this.unsyncedInputsTracker.getUnsyncedInputs(),(e=>Pe(e,this.valueStore)),this.externalMutationTracker),this.externalMutationTracker.start();const r=this.elementDriver.getComponentProps();this.valueStore.reinitializeAllProps(r);const o=this.elementDriver.getEventsToEmit(),a=this.elementDriver.getBrowserEventsToDispatch();Object.keys(s).forEach((e=>{this.valueStore.set(e,s[e])})),o.forEach((({event:e,data:t,target:n,componentName:s})=>{"up"!==n?"self"!==n?this.emit(e,t,s):this.emitSelf(e,t):this.emitUp(e,t,s)})),a.forEach((({event:e,payload:t})=>{this.element.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0}))})),this.hooks.triggerHook("render:finished",this)}calculateDebounce(e){return!0===e?this.defaultDebounce:!1===e?0:e}clearRequestDebounceTimeout(){this.requestDebounceTimeout&&(clearTimeout(this.requestDebounceTimeout),this.requestDebounceTimeout=null)}debouncedStartRequest(e){this.clearRequestDebounceTimeout(),this.requestDebounceTimeout=window.setTimeout((()=>{this.render()}),this.calculateDebounce(e))}renderError(e){let t=document.getElementById("live-component-error");t?t.innerHTML="":(t=document.createElement("div"),t.id="live-component-error",t.style.padding="50px",t.style.backgroundColor="rgba(0, 0, 0, .5)",t.style.zIndex="100000",t.style.position="fixed",t.style.top="0px",t.style.bottom="0px",t.style.left="0px",t.style.right="0px",t.style.display="flex",t.style.flexDirection="column");const n=document.createElement("iframe");n.style.borderRadius="5px",n.style.flexGrow="1",t.appendChild(n),document.body.prepend(t),document.body.style.overflow="hidden",n.contentWindow&&(n.contentWindow.document.open(),n.contentWindow.document.write(e),n.contentWindow.document.close());const s=e=>{e&&(e.outerHTML=""),document.body.style.overflow="visible"};t.addEventListener("click",(()=>s(t))),t.setAttribute("tabindex","0"),t.addEventListener("keydown",(e=>{"Escape"===e.key&&s(t)})),t.focus()}resetPromise(){this.nextRequestPromise=new Promise((e=>{this.nextRequestPromiseResolve=e}))}_updateFromParentProps(e){this.valueStore.storeNewPropsFromParent(e)&&this.render()}}class Ge{constructor(e){this.controller=e}getModelName(e){const t=De(e,!1);return t?t.action:null}getComponentProps(){return this.controller.propsValue}getEventsToEmit(){return this.controller.eventsToEmitValue}getBrowserEventsToDispatch(){return this.controller.eventsToDispatchValue}}function Qe(e){let t=!0,n=null,s=!1;e.modifiers.forEach((i=>{switch(i.name){case"on":if(!i.value)throw new Error(`The "on" modifier in ${e.getString()} requires a value - e.g. on(change).`);if(!["input","change"].includes(i.value))throw new Error(`The "on" modifier in ${e.getString()} only accepts the arguments "input" or "change".`);n=i.value;break;case"norender":t=!1;break;case"debounce":s=!i.value||Number.parseInt(i.value);break;default:throw new Error(`Unknown modifier "${i.name}" in data-model="${e.getString()}".`)}}));const[i,r]=e.action.split(":");return{modelName:i,innerModelName:r||null,shouldRender:t,debounce:s,targetEventName:n}}class Xe{constructor(e){this.parentModelBindings=[],this.component=e;const t=_e(this.component.element);this.parentModelBindings=t.map(Qe)}attachToComponent(e){e.on("request:started",(e=>{e.children=this.getChildrenFingerprints()})),e.on("model:set",((e,t)=>{this.notifyParentModelChange(e,t)}))}getChildrenFingerprints(){const e={};return this.getChildren().forEach((t=>{if(!t.id)throw new Error("missing id");e[t.id]={fingerprint:t.fingerprint,tag:t.element.tagName.toLowerCase()}})),e}notifyParentModelChange(e,t){const n=(e=>{let t=e.element.parentElement;for(;t;){const e=Se.get(t);if(e)return e;t=t.parentElement}return null})(this.component);n&&this.parentModelBindings.forEach((s=>{(s.innerModelName||"value")===e&&n.set(s.modelName,t,s.shouldRender,s.debounce)}))}getChildren(){return(e=>{const t=[];return Ce.forEach(((n,s)=>{if(e===s)return;if(!e.element.contains(s.element))return;let i=!1;Ce.forEach(((e,t)=>{i||t!==s&&t.element.contains(s.element)&&(i=!0)})),t.push(s)})),t})(this.component)}}class Ye{constructor(){this.intersectionObserver=null}attachToComponent(e){"lazy"===e.element.attributes.getNamedItem("loading")?.value&&(e.on("connect",(()=>{this.getObserver().observe(e.element)})),e.on("disconnect",(()=>{this.intersectionObserver?.unobserve(e.element)})))}getObserver(){return this.intersectionObserver||(this.intersectionObserver=new IntersectionObserver(((e,t)=>{e.forEach((e=>{e.isIntersecting&&(e.target.dispatchEvent(new CustomEvent("live:appear")),t.unobserve(e.target))}))}))),this.intersectionObserver}}class Ze{attachToComponent(e){e.on("loading.state:started",((t,n)=>{this.startLoading(e,t,n)})),e.on("loading.state:finished",(t=>{this.finishLoading(e,t)})),this.finishLoading(e,e.element)}startLoading(e,t,n){this.handleLoadingToggle(e,!0,t,n)}finishLoading(e,t){this.handleLoadingToggle(e,!1,t,null)}handleLoadingToggle(e,t,n,s){t?this.addAttributes(n,["busy"]):this.removeAttributes(n,["busy"]),this.getLoadingDirectives(e,n).forEach((({element:e,directives:n})=>{t?this.addAttributes(e,["data-live-is-loading"]):this.removeAttributes(e,["data-live-is-loading"]),n.forEach((n=>{this.handleLoadingDirective(e,t,n,s)}))}))}handleLoadingDirective(e,t,n,s){const i=et(n.action,t),r=[],o=[];let a=0;const l=new Map;if(l.set("delay",(e=>{t&&(a=e.value?Number.parseInt(e.value):200)})),l.set("action",(e=>{if(!e.value)throw new Error(`The "action" in data-loading must have an action name - e.g. action(foo). It's missing for "${n.getString()}"`);r.push(e.value)})),l.set("model",(e=>{if(!e.value)throw new Error(`The "model" in data-loading must have an action name - e.g. model(foo). It's missing for "${n.getString()}"`);o.push(e.value)})),n.modifiers.forEach((e=>{if(!l.has(e.name))throw new Error(`Unknown modifier "${e.name}" used in data-loading="${n.getString()}". Available modifiers are: ${Array.from(l.keys()).join(", ")}.`);(l.get(e.name)??(()=>{}))(e)})),t&&r.length>0&&s&&!s.containsOneOfActions(r))return;if(t&&o.length>0&&s&&!s.areAnyModelsUpdated(o))return;let c;switch(i){case"show":c=()=>this.showElement(e);break;case"hide":c=()=>this.hideElement(e);break;case"addClass":c=()=>this.addClass(e,n.args);break;case"removeClass":c=()=>this.removeClass(e,n.args);break;case"addAttribute":c=()=>this.addAttributes(e,n.args);break;case"removeAttribute":c=()=>this.removeAttributes(e,n.args);break;default:throw new Error(`Unknown data-loading action "${i}"`)}a?window.setTimeout((()=>{s&&!s.isResolved&&c()}),a):c()}getLoadingDirectives(e,t){const n=[];let s=[...Array.from(t.querySelectorAll("[data-loading]"))];return s=s.filter((t=>Ve(t,e))),t.hasAttribute("data-loading")&&(s=[t,...s]),s.forEach((e=>{if(!(e instanceof HTMLElement||e instanceof SVGElement))throw new Error("Invalid Element Type");const t=Ie(e.dataset.loading||"show");n.push({element:e,directives:t})})),n}showElement(e){e.style.display="revert"}hideElement(e){e.style.display="none"}addClass(e,t){e.classList.add(...Ne(t))}removeClass(e,t){e.classList.remove(...Ne(t)),0===e.classList.length&&e.removeAttribute("class")}addAttributes(e,t){t.forEach((t=>{e.setAttribute(t,"")}))}removeAttributes(e,t){t.forEach((t=>{e.removeAttribute(t)}))}}const et=(e,t)=>{switch(e){case"show":return t?"show":"hide";case"hide":return t?"hide":"show";case"addClass":return t?"addClass":"removeClass";case"removeClass":return t?"removeClass":"addClass";case"addAttribute":return t?"addAttribute":"removeAttribute";case"removeAttribute":return t?"removeAttribute":"addAttribute"}throw new Error(`Unknown data-loading action "${e}"`)};class tt{constructor(){this.isConnected=!1}attachToComponent(e){e.on("render:started",((e,t,n)=>{this.isConnected||(n.shouldRender=!1)})),e.on("connect",(()=>{this.isConnected=!0})),e.on("disconnect",(()=>{this.isConnected=!1}))}}class nt{constructor(e){this.isPollingActive=!0,this.pollingIntervals=[],this.component=e}addPoll(e,t){this.polls.push({actionName:e,duration:t}),this.isPollingActive&&this.initiatePoll(e,t)}startAllPolling(){this.isPollingActive||(this.isPollingActive=!0,this.polls.forEach((({actionName:e,duration:t})=>{this.initiatePoll(e,t)})))}stopAllPolling(){this.isPollingActive=!1,this.pollingIntervals.forEach((e=>{clearInterval(e)}))}clearPolling(){this.stopAllPolling(),this.polls=[],this.startAllPolling()}initiatePoll(e,t){let n;n="$render"===e?()=>{this.component.render()}:()=>{this.component.action(e,{},0)};const s=window.setInterval((()=>{n()}),t);this.pollingIntervals.push(s)}}class st{attachToComponent(e){this.element=e.element,this.pollingDirector=new nt(e),this.initializePolling(),e.on("connect",(()=>{this.pollingDirector.startAllPolling()})),e.on("disconnect",(()=>{this.pollingDirector.stopAllPolling()})),e.on("render:finished",(()=>{this.initializePolling()}))}addPoll(e,t){this.pollingDirector.addPoll(e,t)}clearPolling(){this.pollingDirector.clearPolling()}initializePolling(){if(this.clearPolling(),void 0===this.element.dataset.poll)return;const e=this.element.dataset.poll;Ie(e||"$render").forEach((t=>{let n=2e3;t.modifiers.forEach((t=>{if("delay"===t.name)t.value&&(n=Number.parseInt(t.value));else console.warn(`Unknown modifier "${t.name}" in data-poll "${e}".`)})),this.addPoll(t.action,n)}))}}function it(e){if(null===e||""===e||void 0===e||Array.isArray(e)&&0===e.length)return!0;if("object"!=typeof e)return!1;for(const t of Object.keys(e))if(!it(e[t]))return!1;return!0}function rt(e){const t=(e,n={},s="")=>(Object.entries(e).forEach((([e,i])=>{const r=""===s?e:`${s}[${e}]`;""===s&&it(i)?n[r]="":null!==i&&("object"==typeof i?n={...n,...t(i,n,r)}:n[r]=encodeURIComponent(i).replace(/%20/g,"+").replace(/%2C/g,","))})),n),n=t(e);return Object.entries(n).map((([e,t])=>`${e}=${t}`)).join("&")}class ot extends URL{has(e){const t=this.getData();return Object.keys(t).includes(e)}set(e,t){const n=this.getData();n[e]=t,this.setData(n)}get(e){return this.getData()[e]}remove(e){const t=this.getData();delete t[e],this.setData(t)}getData(){return this.search?function(e){if(""===(e=e.replace("?","")))return{};const t=(e,n,s)=>{const[i,r,...o]=e.split(".");if(!r)return s[e]=n,n;void 0===s[i]&&(s[i]=Number.isNaN(Number.parseInt(r))?{}:[]),t([r,...o].join("."),n,s[i])},n=e.split("&").map((e=>e.split("="))),s={};return n.forEach((([e,n])=>{if(n=decodeURIComponent(n.replace(/\+/g,"%20")),e.includes("[")){if(""===n)return;const i=e.replace(/\[/g,".").replace(/]/g,"");t(i,n,s)}else s[e]=n})),s}(this.search):{}}setData(e){this.search=rt(e)}}class at{static replace(e){history.replaceState(history.state,"",e)}}class lt{constructor(e){this.mapping=e}attachToComponent(e){e.on("render:finished",(e=>{const t=new ot(window.location.href),n=t.toString();Object.entries(this.mapping).forEach((([n,s])=>{const i=e.valueStore.get(n);t.set(s.name,i)})),n!==t.toString()&&at.replace(t)}))}}class ct{attachToComponent(e){this.synchronizeValueOfModelFields(e),e.on("render:finished",(()=>{this.synchronizeValueOfModelFields(e)}))}synchronizeValueOfModelFields(e){e.element.querySelectorAll("[data-model]").forEach((t=>{if(!(t instanceof HTMLElement))throw new Error("Invalid element using data-model.");if(t instanceof HTMLFormElement)return;if(!Ve(t,e))return;const n=De(t);if(!n)return;const s=n.action;e.getUnsyncedModels().includes(s)||(e.valueStore.has(s)&&$e(t,e.valueStore.get(s)),t instanceof HTMLSelectElement&&!t.multiple&&e.valueStore.set(s,Pe(t,e.valueStore)))}))}}class dt{attachToComponent(e){e.on("model:set",(t=>{this.handleModelSet(t,e.valueStore)}))}handleModelSet(e,t){if(t.has("validatedFields")){const n=[...t.get("validatedFields")];n.includes(e)||n.push(e),t.set("validatedFields",n)}}}class ht extends ae{constructor(){super(...arguments),this.pendingActionTriggerModelElement=null,this.elementEventListeners=[{event:"input",callback:e=>this.handleInputEvent(e)},{event:"change",callback:e=>this.handleChangeEvent(e)}],this.pendingFiles={}}initialize(){this.mutationObserver=new MutationObserver(this.onMutations.bind(this)),this.createComponent()}connect(){this.connectComponent(),this.mutationObserver.observe(this.element,{attributes:!0})}disconnect(){this.disconnectComponent(),this.mutationObserver.disconnect()}update(e){if("input"===e.type||"change"===e.type)throw new Error(`Since LiveComponents 2.3, you no longer need data-action="live#update" on form elements. Found on element: ${ke(e.currentTarget)}`);this.updateModelFromElementEvent(e.currentTarget,null)}action(e){const t=e.params;if(!t.action)throw new Error(`No action name provided on element: ${ke(e.currentTarget)}. Did you forget to add the "data-live-action-param" attribute?`);const n=t.action,s={...t};delete s.action;const i=Ie(n);let r=!1;i.forEach((t=>{let i={};const o=new Map;o.set("stop",(()=>{e.stopPropagation()})),o.set("self",(()=>{e.target,e.currentTarget})),o.set("debounce",(e=>{r=!e.value||Number.parseInt(e.value)})),o.set("files",(e=>{e.value?this.pendingFiles[e.value]&&(i[e.value]=this.pendingFiles[e.value]):i=this.pendingFiles})),t.modifiers.forEach((e=>{if(o.has(e.name)){(o.get(e.name)??(()=>{}))(e)}else console.warn(`Unknown modifier ${e.name} in action "${n}". Available modifiers are: ${Array.from(o.keys()).join(", ")}.`)}));for(const[e,t]of Object.entries(i))t.files&&this.component.files(e,t),delete this.pendingFiles[e];this.component.action(t.action,s,r),De(e.currentTarget,!1)&&(this.pendingActionTriggerModelElement=e.currentTarget)}))}$render(){return this.component.render()}emit(e){this.getEmitDirectives(e).forEach((({name:e,data:t,nameMatch:n})=>{this.component.emit(e,t,n)}))}emitUp(e){this.getEmitDirectives(e).forEach((({name:e,data:t,nameMatch:n})=>{this.component.emitUp(e,t,n)}))}emitSelf(e){this.getEmitDirectives(e).forEach((({name:e,data:t})=>{this.component.emitSelf(e,t)}))}$updateModel(e,t,n=!0,s=!0){return this.component.set(e,t,n,s)}propsUpdatedFromParentValueChanged(){this.component._updateFromParentProps(this.propsUpdatedFromParentValue)}fingerprintValueChanged(){this.component.fingerprint=this.fingerprintValue}getEmitDirectives(e){const t=e.params;if(!t.event)throw new Error(`No event name provided on element: ${ke(e.currentTarget)}. Did you forget to add the "data-live-event-param" attribute?`);const n=t.event,s={...t};delete s.event;const i=Ie(n),r=[];return i.forEach((e=>{let t=null;e.modifiers.forEach((e=>{if("name"!==e.name)throw new Error(`Unknown modifier ${e.name} in event "${n}".`);t=e.value})),r.push({name:e.action,data:s,nameMatch:t})})),r}createComponent(){const e=this.element.id||null;var t;this.component=new Je(this.element,this.nameValue,this.propsValue,this.listenersValue,e,ht.backendFactory(this),new Ge(this)),this.proxiedComponent=(t=this.component,new Proxy(t,{get(e,t){if(t in e||"string"!=typeof t){if("function"==typeof e[t]){const n=e[t];return(...t)=>n.apply(e,t)}return Reflect.get(e,t)}return e.valueStore.has(t)?e.getData(t):n=>e.action.apply(e,[t,n])},set:(e,t,n)=>t in e?(e[t]=n,!0):(e.set(t,n),!0)})),this.element.__component=this.proxiedComponent,this.hasDebounceValue&&(this.component.defaultDebounce=this.debounceValue);[new Ze,new Ye,new dt,new tt,new st,new ct,new lt(this.queryMappingValue),new Xe(this.component)].forEach((e=>{this.component.addPlugin(e)}))}connectComponent(){this.component.connect(),this.mutationObserver.observe(this.element,{attributes:!0}),this.elementEventListeners.forEach((({event:e,callback:t})=>{this.component.element.addEventListener(e,t)})),this.dispatchEvent("connect")}disconnectComponent(){this.component.disconnect(),this.elementEventListeners.forEach((({event:e,callback:t})=>{this.component.element.removeEventListener(e,t)})),this.dispatchEvent("disconnect")}handleInputEvent(e){const t=e.target;t&&this.updateModelFromElementEvent(t,"input")}handleChangeEvent(e){const t=e.target;t&&this.updateModelFromElementEvent(t,"change")}updateModelFromElementEvent(e,t){if(!Ve(e,this.component))return;if(!(e instanceof HTMLElement))throw new Error("Could not update model for non HTMLElement");if(e instanceof HTMLInputElement&&"file"===e.type){const t=e.name;e.files?.length?this.pendingFiles[t]=e:this.pendingFiles[t]&&delete this.pendingFiles[t]}const n=De(e,!1);if(!n)return;const s=Qe(n);if(s.targetEventName||(s.targetEventName="input"),this.pendingActionTriggerModelElement===e&&(s.shouldRender=!1),"change"===t&&"input"===s.targetEventName&&(s.targetEventName="change"),t&&s.targetEventName!==t)return;!1===s.debounce&&("input"===s.targetEventName?s.debounce=!0:s.debounce=0);const i=Pe(e,this.component.valueStore);this.component.set(s.modelName,i,s.shouldRender,s.debounce)}dispatchEvent(e,t={},n=!0,s=!1){t.controller=this,t.component=this.proxiedComponent,this.dispatch(e,{detail:t,prefix:"live",cancelable:s,bubbles:n})}onMutations(e){e.forEach((e=>{"attributes"===e.type&&"id"===e.attributeName&&this.element.id!==this.component.id&&(this.disconnectComponent(),this.createComponent(),this.connectComponent())}))}}ht.values={name:String,url:String,props:{type:Object,default:{}},propsUpdatedFromParent:{type:Object,default:{}},listeners:{type:Array,default:[]},eventsToEmit:{type:Array,default:[]},eventsToDispatch:{type:Array,default:[]},debounce:{type:Number,default:150},fingerprint:{type:String,default:""},requestMethod:{type:String,default:"post"},queryMapping:{type:Object,default:{}}},ht.backendFactory=e=>new we(e.urlValue,e.requestMethodValue);const ut={"symfony--ux-autocomplete--autocomplete":ye,live:ht};function pt(e){return e.keys().map((t=>function(e,t){const n=function(e){const t=(e.match(/^(?:\.\/)?(.+)(?:[_-]controller\..+?)$/)||[])[1];if(t)return t.replace(/_/g,"-").replace(/\//g,"--")}(t);if(n)return function(e,t){const n=e.default;if("function"==typeof n)return{identifier:t,controllerConstructor:n}}(e(t),n)}(e,t))).filter((e=>e))}!function(e){const t=X.start();e&&t.load(pt(e));for(const e in ut)ut.hasOwnProperty(e)&&t.register(e,ut[e])}(n(490))})()})();